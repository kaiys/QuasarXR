"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45],{2085:function(e,t,n){/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.19.2
 * @author George Michael Brower
 * @license MIT
 */class i{name(e){return this._name=e,this.$name.textContent=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this.disable(!e)}disable(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){let t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._listening=e,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);let e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.getValue()!==e&&(this.object[this.property]=e,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}constructor(e,t,n,s,r="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(r),this.domElement.classList.add("controller"),this.domElement.classList.add(s),this.$name=document.createElement("div"),this.$name.classList.add("name"),i.nextNameID=i.nextNameID||0,this.$name.id="lil-gui-name-".concat(++i.nextNameID),this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",e=>e.stopPropagation()),this.domElement.addEventListener("keyup",e=>e.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}}class s extends i{updateDisplay(){return this.$input.checked=this.getValue(),this}constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}}function r(e){let t,n;return(t=e.match(/(#|0x)?([a-f0-9]{6})/i))?n=t[2]:(t=e.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?n=parseInt(t[1]).toString(16).padStart(2,0)+parseInt(t[2]).toString(16).padStart(2,0)+parseInt(t[3]).toString(16).padStart(2,0):(t=e.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(n=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),!!n&&"#"+n}let o={isPrimitive:!0,match:e=>"number"==typeof e,fromHexString:e=>parseInt(e.substring(1),16),toHexString:e=>"#"+e.toString(16).padStart(6,0)},a=[{isPrimitive:!0,match:e=>"string"==typeof e,fromHexString:r,toHexString:r},o,{isPrimitive:!1,match:e=>Array.isArray(e),fromHexString(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=o.fromHexString(e);t[0]=(i>>16&255)/255*n,t[1]=(i>>8&255)/255*n,t[2]=(255&i)/255*n},toHexString(e){let[t,n,i]=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t*(s=255/s)<<16^n*s<<8^i*s<<0;return o.toHexString(r)}},{isPrimitive:!1,match:e=>Object(e)===e,fromHexString(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=o.fromHexString(e);t.r=(i>>16&255)/255*n,t.g=(i>>8&255)/255*n,t.b=(255&i)/255*n},toHexString(e){let{r:t,g:n,b:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t*(s=255/s)<<16^n*s<<8^i*s<<0;return o.toHexString(r)}}];class l extends i{reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){let t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}constructor(e,t,n,i){var s;super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(s=this.initialValue,a.find(e=>e.match(s))),this._rgbScale=i,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{let e=r(this.$text.value);e&&this._setValueFromHexString(e)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}}class h extends i{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",e=>{e.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class c extends i{decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this._step=e,this._stepExplicit=t,this}updateDisplay(){let e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;let e=e=>{let t=parseFloat(this.$input.value);isNaN(t)||(this._snapClampSetValue(t+e),this.$input.value=this.getValue())},t=!1,n,i,s,r,o,a=e=>{if(t){let s=e.clientX-n;Math.abs(e.clientY-i)>5?(e.preventDefault(),this.$input.blur(),t=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(s)>5&&l()}if(!t){let t=e.clientY-s;o-=t*this._step*this._arrowKeyMultiplier(e),r+o>this._max?o=this._max-r:r+o<this._min&&(o=this._min-r),this._snapClampSetValue(r+o)}s=e.clientY},l=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",l)};this.$input.addEventListener("input",()=>{let e=parseFloat(this.$input.value);isNaN(e)||(this._stepExplicit&&(e=this._snap(e)),this.setValue(this._clamp(e)))}),this.$input.addEventListener("keydown",t=>{"Enter"===t.key&&this.$input.blur(),"ArrowUp"===t.code&&(t.preventDefault(),e(this._step*this._arrowKeyMultiplier(t))),"ArrowDown"===t.code&&(t.preventDefault(),e(-(this._step*this._arrowKeyMultiplier(t)*1)))}),this.$input.addEventListener("wheel",t=>{this._inputFocused&&(t.preventDefault(),e(this._step*this._normalizeMouseWheel(t)))},{passive:!1}),this.$input.addEventListener("mousedown",e=>{n=e.clientX,i=s=e.clientY,t=!0,r=this.getValue(),o=0,window.addEventListener("mousemove",a),window.addEventListener("mouseup",l)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){let e;this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");let t=(e,t,n,i,s)=>(e-t)/(n-t)*(s-i)+i,n=e=>{let n=this.$slider.getBoundingClientRect(),i=t(e,n.left,n.right,this._min,this._max);this._snapClampSetValue(i)},i=e=>{n(e.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",s)},r=!1,o,a,l=e=>{e.preventDefault(),this._setDraggingStyle(!0),n(e.touches[0].clientX),r=!1},h=e=>{r?Math.abs(e.touches[0].clientX-o)>Math.abs(e.touches[0].clientY-a)?l(e):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",c)):(e.preventDefault(),n(e.touches[0].clientX))},c=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",c)},u=this._callOnFinishChange.bind(this);this.$slider.addEventListener("mousedown",e=>{this._setDraggingStyle(!0),n(e.clientX),window.addEventListener("mousemove",i),window.addEventListener("mouseup",s)}),this.$slider.addEventListener("touchstart",e=>{e.touches.length>1||(this._hasScrollBar?(o=e.touches[0].clientX,a=e.touches[0].clientY,r=!0):l(e),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",c))},{passive:!1}),this.$slider.addEventListener("wheel",t=>{if(Math.abs(t.deltaX)<Math.abs(t.deltaY)&&this._hasScrollBar)return;t.preventDefault();let n=this._normalizeMouseWheel(t)*this._step;this._snapClampSetValue(this.getValue()+n),this.$input.value=this.getValue(),clearTimeout(e),e=setTimeout(u,400)},{passive:!1})}_setDraggingStyle(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"horizontal";this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle("lil-gui-".concat(t),e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120*(this._stepExplicit?1:10)),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){return parseFloat((Math.round(e/this._step)*this._step).toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){let e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}constructor(e,t,n,i,s,r){super(e,t,n,"number"),this._initInput(),this.min(i),this.max(s);let o=void 0!==r;this.step(o?r:this._getImplicitStep(),o),this.updateDisplay()}}class u extends i{options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(e=>{let t=document.createElement("option");t.textContent=e,this.$select.appendChild(t)}),this.updateDisplay(),this}updateDisplay(){let e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.textContent=-1===t?e:this._names[t],this}constructor(e,t,n,i){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(i)}}class d extends i{updateDisplay(){return this.$input.value=this.getValue(),this}constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",e=>{"Enter"===e.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}}let p=!1;class m{add(e,t,n,i,r){if(Object(n)===n)return new u(this,e,t,n);let o=e[t];switch(typeof o){case"number":return new c(this,e,t,n,i,r);case"boolean":return new s(this,e,t);case"string":return new d(this,e,t);case"function":return new h(this,e,t)}console.error("gui.add failed\n	property:",t,"\n	object:",e,"\n	value:",o)}addColor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new l(this,e,t,n)}addFolder(e){let t=new m({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return e.controllers&&this.controllers.forEach(t=>{!(t instanceof h)&&t._name in e.controllers&&t.load(e.controllers[t._name])}),t&&e.folders&&this.folders.forEach(t=>{t._title in e.folders&&t.load(e.folders[t._title])}),this}save(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t={controllers:{},folders:{}};return this.controllers.forEach(e=>{if(!(e instanceof h)){if(e._name in t.controllers)throw Error('Cannot save GUI with duplicate property "'.concat(e._name,'"'));t.controllers[e._name]=e.save()}}),e&&this.folders.forEach(e=>{if(e._title in t.folders)throw Error('Cannot save GUI with duplicate folder "'.concat(e._title,'"'));t.folders[e._title]=e.save()}),t}open(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{let t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");let n=e=>{e.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);let i=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=i+"px"})}),this}title(e){return this._title=e,this.$title.textContent=e,this}reset(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return(e?this.controllersRecursive():this.controllers).forEach(e=>e.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),void 0!==this._onChange&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),void 0!==this._onOpenClose&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}constructor({parent:e,autoPlace:t=void 0===e,container:n,width:i,title:s="Controls",closeFolders:r=!1,injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",e=>{("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),a&&this.domElement.classList.add("allow-touch-styles"),!p&&o&&(function(e){let t=document.createElement("style");t.innerHTML=e;let n=document.querySelector("head link[rel=stylesheet], head style");n?document.head.insertBefore(t,n):document.head.appendChild(t)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n  background: var(--background-color);\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "↕";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "▾";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "▸";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui label, .lil-gui input, .lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n}\n.lil-gui input {\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  width: var(--checkbox-size);\n  height: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "✓";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: none;\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),p=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.style.setProperty("--width",i+"px"),this._closeFolders=r}}t.ZP=m},7610:function(e,t,n){let i,s,r,o,a,l;n.d(t,{uL:function(){return e6},Xy:function(){return e8},sn:function(){return e7}});var h=n(6376);function c(e,t,n){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e.distance<n.near||e.distance>n.far)?null:e}let u=Symbol("SKIP_GENERATION");function d(e){return(e.index?e.index.count:e.attributes.position.count)/3}function p(e){let t=d(e),n=e.drawRange,i=n.start/3,s=(n.start+n.count)/3,r=Math.max(0,i);return[{offset:Math.floor(r),count:Math.floor(Math.min(t,s)-r)}]}function m(e){if(!e.groups||!e.groups.length)return p(e);let t=[],n=new Set,i=e.drawRange,s=i.start/3,r=(i.start+i.count)/3;for(let t of e.groups){let e=t.start/3,i=(t.start+t.count)/3;n.add(Math.max(s,e)),n.add(Math.min(r,i))}let o=Array.from(n.values()).sort((e,t)=>e-t);for(let e=0;e<o.length-1;e++){let n=o[e],i=o[e+1];t.push({offset:Math.floor(n),count:Math.floor(i-n)})}return t}function f(e,t,n,i,s){let r=1/0,o=1/0,a=1/0,l=-1/0,h=-1/0,c=-1/0,u=1/0,d=1/0,p=1/0,m=-1/0,f=-1/0,g=-1/0;for(let i=6*t,s=(t+n)*6;i<s;i+=6){let t=e[i+0],n=e[i+1],s=t-n,y=t+n;s<r&&(r=s),y>l&&(l=y),t<u&&(u=t),t>m&&(m=t);let v=e[i+2],x=e[i+3],w=v-x,A=v+x;w<o&&(o=w),A>h&&(h=A),v<d&&(d=v),v>f&&(f=v);let b=e[i+4],E=e[i+5],T=b-E,_=b+E;T<a&&(a=T),_>c&&(c=_),b<p&&(p=b),b>g&&(g=b)}i[0]=r,i[1]=o,i[2]=a,i[3]=l,i[4]=h,i[5]=c,s[0]=u,s[1]=d,s[2]=p,s[3]=m,s[4]=f,s[5]=g}function g(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function y(e){let t=-1,n=-1/0;for(let i=0;i<3;i++){let s=e[i+3]-e[i];s>n&&(n=s,t=i)}return t}function v(e,t,n){let i,s;for(let r=0;r<3;r++){let o=r+3;i=e[r],s=t[r],n[r]=i<s?i:s,i=e[o],s=t[o],n[o]=i>s?i:s}}function x(e,t,n){for(let i=0;i<3;i++){let s=t[e+2*i],r=t[e+2*i+1],o=s-r,a=s+r;o<n[i]&&(n[i]=o),a>n[i+3]&&(n[i+3]=a)}}function w(e){let t=e[3]-e[0],n=e[4]-e[1],i=e[5]-e[2];return 2*(t*n+n*i+i*t)}let A=(e,t)=>e.candidate-t.candidate,b=Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),E=new Float32Array(6);class T{constructor(){this.boundingData=new Float32Array(6)}}function _(e,t,n,i,s,r){let o=i,a=i+s-1,l=r.pos,h=2*r.axis;for(;;){for(;o<=a&&n[6*o+h]<l;)o++;for(;o<=a&&n[6*a+h]>=l;)a--;if(!(o<a))return o;for(let e=0;e<3;e++){let n=t[3*o+e];t[3*o+e]=t[3*a+e],t[3*a+e]=n}for(let e=0;e<6;e++){let t=n[6*o+e];n[6*o+e]=n[6*a+e],n[6*a+e]=t}o++,a--}}function P(e,t,n,i,s,r){let o=i,a=i+s-1,l=r.pos,h=2*r.axis;for(;;){for(;o<=a&&n[6*o+h]<l;)o++;for(;o<=a&&n[6*a+h]>=l;)a--;if(!(o<a))return o;{let t=e[o];e[o]=e[a],e[a]=t;for(let e=0;e<6;e++){let t=n[6*o+e];n[6*o+e]=n[6*a+e],n[6*a+e]=t}o++,a--}}}function M(e,t){return 65535===t[e+15]}function S(e,t){return t[e+14]}class I{setFromPointsField(e,t){let n=1/0,i=-1/0;for(let s=0,r=e.length;s<r;s++){let r=e[s][t];n=r<n?r:n,i=r>i?r:i}this.min=n,this.max=i}setFromPoints(e,t){let n=1/0,i=-1/0;for(let s=0,r=t.length;s<r;s++){let r=t[s],o=e.dot(r);n=o<n?o:n,i=o>i?o:i}this.min=n,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}constructor(){this.min=1/0,this.max=-1/0}}I.prototype.setFromBox=function(){let e=new h.Pa4;return function(t,n){let i=n.min,s=n.max,r=1/0,o=-1/0;for(let n=0;n<=1;n++)for(let a=0;a<=1;a++)for(let l=0;l<=1;l++){e.x=i.x*n+s.x*(1-n),e.y=i.y*a+s.y*(1-a),e.z=i.z*l+s.z*(1-l);let h=t.dot(e);r=Math.min(h,r),o=Math.max(h,o)}this.min=r,this.max=o}}(),new I;let R=function(){let e=new h.Pa4,t=new h.Pa4,n=new h.Pa4;return function(i,s,r){let o,a;let l=i.start,h=s.start;n.subVectors(l,h),e.subVectors(i.end,i.start),t.subVectors(s.end,s.start);let c=n.dot(t),u=t.dot(e),d=t.dot(t),p=n.dot(e),m=e.dot(e)*d-u*u;o=0!==m?(c*u-p*d)/m:0,a=(c+o*u)/d,r.x=o,r.y=a}}(),L=function(){let e=new h.FM8,t=new h.Pa4,n=new h.Pa4;return function(i,s,r,o){R(i,s,e);let a=e.x,l=e.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,r),s.at(l,o);return}if(a>=0&&a<=1){l<0?s.at(0,o):s.at(1,o),i.closestPointToPoint(o,!0,r);return}if(l>=0&&l<=1){a<0?i.at(0,r):i.at(1,r),s.closestPointToPoint(r,!0,o);return}{let e,h;if(e=a<0?i.start:i.end,h=l<0?s.start:s.end,i.closestPointToPoint(h,!0,t),s.closestPointToPoint(e,!0,n),t.distanceToSquared(h)<=n.distanceToSquared(e)){r.copy(t),o.copy(h);return}r.copy(e),o.copy(n);return}}}(),C=function(){let e=new h.Pa4,t=new h.Pa4,n=new h.JOQ,i=new h.Zzh;return function(s,r){let{radius:o,center:a}=s,{a:l,b:h,c}=r;if(i.start=l,i.end=h,i.closestPointToPoint(a,!0,e).distanceTo(a)<=o||(i.start=l,i.end=c,i.closestPointToPoint(a,!0,e).distanceTo(a)<=o)||(i.start=h,i.end=c,i.closestPointToPoint(a,!0,e).distanceTo(a)<=o))return!0;let u=r.getPlane(n);if(Math.abs(u.distanceToPoint(a))<=o){let e=u.projectPoint(a,t);if(r.containsPoint(e))return!0}return!1}}();function B(e){return 1e-15>Math.abs(e)}class F extends h.CJI{intersectsSphere(e){return C(e,this)}update(){let e=this.a,t=this.b,n=this.c,i=this.points,s=this.satAxes,r=this.satBounds,o=s[0],a=r[0];this.getNormal(o),a.setFromPoints(o,i);let l=s[1],h=r[1];l.subVectors(e,t),h.setFromPoints(l,i);let c=s[2],u=r[2];c.subVectors(t,n),u.setFromPoints(c,i);let d=s[3],p=r[3];d.subVectors(n,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=[,,,,].fill().map(()=>new h.Pa4),this.satBounds=[,,,,].fill().map(()=>new I),this.points=[this.a,this.b,this.c],this.sphere=new h.aLr,this.plane=new h.JOQ,this.needsUpdate=!0}}F.prototype.closestPointToSegment=function(){let e=new h.Pa4,t=new h.Pa4,n=new h.Zzh;return function(i){let s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:a,end:l}=i,h=this.points,c=1/0;for(let a=0;a<3;a++){let l=(a+1)%3;n.start.copy(h[a]),n.end.copy(h[l]),L(n,i,e,t),(s=e.distanceToSquared(t))<c&&(c=s,r&&r.copy(e),o&&o.copy(t))}return this.closestPointToPoint(a,e),(s=a.distanceToSquared(e))<c&&(c=s,r&&r.copy(e),o&&o.copy(a)),this.closestPointToPoint(l,e),(s=l.distanceToSquared(e))<c&&(c=s,r&&r.copy(e),o&&o.copy(l)),Math.sqrt(c)}}(),F.prototype.intersectsTriangle=function(){let e=new F,t=[,,,],n=[,,,],i=new I,s=new I,r=new h.Pa4,o=new h.Pa4,a=new h.Pa4,l=new h.Pa4,c=new h.Pa4,u=new h.Zzh,d=new h.Zzh,p=new h.Zzh,m=new h.Pa4;function f(e,t,n){let i=e.points,s=0,r=-1;for(let e=0;e<3;e++){let{start:a,end:l}=u;a.copy(i[e]),l.copy(i[(e+1)%3]),u.delta(o);let h=B(t.distanceToPoint(a));if(B(t.normal.dot(o))&&h){n.copy(u),s=2;break}let c=t.intersectLine(u,m);if(!c&&h&&m.copy(a),(c||h)&&!B(m.distanceTo(l))){if(s<=1)(1===s?n.start:n.end).copy(m),h&&(r=s);else if(s>=2){(1===r?n.start:n.end).copy(m),s=2;break}if(2==++s&&-1===r)break}}return s}return function(o){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);let m=this.plane,g=o.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let e=this.satBounds,a=this.satAxes;n[0]=o.a,n[1]=o.b,n[2]=o.c;for(let t=0;t<4;t++){let s=e[t],r=a[t];if(i.setFromPoints(r,n),s.isSeparated(i))return!1}let l=o.satBounds,c=o.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){let n=l[e],s=c[e];if(i.setFromPoints(s,t),n.isSeparated(i))return!1}for(let e=0;e<4;e++){let o=a[e];for(let e=0;e<4;e++){let a=c[e];if(r.crossVectors(o,a),i.setFromPoints(r,t),s.setFromPoints(r,n),i.isSeparated(s))return!1}}return h&&(u||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),h.start.set(0,0,0),h.end.set(0,0,0)),!0}{let e=f(this,g,d);if(1===e&&o.containsPoint(d.end))return h&&(h.start.copy(d.end),h.end.copy(d.end)),!0;if(2!==e)return!1;let t=f(o,m,p);if(1===t&&this.containsPoint(p.end))return h&&(h.start.copy(p.end),h.end.copy(p.end)),!0;if(2!==t)return!1;if(d.delta(a),p.delta(l),0>a.dot(l)){let e=p.start;p.start=p.end,p.end=e}let n=d.start.dot(a),i=d.end.dot(a),s=p.start.dot(a),r=p.end.dot(a);return(n===r||s===i||i<s!=n<r)&&(h&&(c.subVectors(d.start,p.start),c.dot(a)>0?h.start.copy(d.start):h.start.copy(p.start),c.subVectors(d.end,p.end),0>c.dot(a)?h.end.copy(d.end):h.end.copy(p.end)),!0)}}}(),F.prototype.distanceToPoint=function(){let e=new h.Pa4;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),F.prototype.distanceToTriangle=function(){let e=new h.Pa4,t=new h.Pa4,n=["a","b","c"],i=new h.Zzh,s=new h.Zzh;return function(r){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=o||a?i:null;if(this.intersectsTriangle(r,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let h=1/0;for(let t=0;t<3;t++){let i;let s=n[t],l=r[s];this.closestPointToPoint(l,e),(i=l.distanceToSquared(e))<h&&(h=i,o&&o.copy(e),a&&a.copy(l));let c=this[s];r.closestPointToPoint(c,e),(i=c.distanceToSquared(e))<h&&(h=i,o&&o.copy(c),a&&a.copy(e))}for(let l=0;l<3;l++){let c=n[l],u=n[(l+1)%3];i.set(this[c],this[u]);for(let l=0;l<3;l++){let c=n[l],u=n[(l+1)%3];s.set(r[c],r[u]),L(i,s,e,t);let d=e.distanceToSquared(t);d<h&&(h=d,o&&o.copy(e),a&&a.copy(t))}}return Math.sqrt(h)}}();class O{set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}constructor(e,t,n){this.isOrientedBox=!0,this.min=new h.Pa4,this.max=new h.Pa4,this.matrix=new h.yGw,this.invMatrix=new h.yGw,this.points=Array(8).fill().map(()=>new h.Pa4),this.satAxes=[,,,].fill().map(()=>new h.Pa4),this.satBounds=[,,,].fill().map(()=>new I),this.alignedSatBounds=[,,,].fill().map(()=>new I),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}}O.prototype.update=function(){let e=this.matrix,t=this.min,n=this.max,i=this.points;for(let s=0;s<=1;s++)for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let a=i[1*s|2*r|4*o];a.x=s?n.x:t.x,a.y=r?n.y:t.y,a.z=o?n.z:t.z,a.applyMatrix4(e)}let s=this.satBounds,r=this.satAxes,o=i[0];for(let e=0;e<3;e++){let t=r[e],n=s[e],a=i[1<<e];t.subVectors(o,a),n.setFromPoints(t,i)}let a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},O.prototype.intersectsBox=function(){let e=new I;return function(t){this.needsUpdate&&this.update();let n=t.min,i=t.max,s=this.satBounds,r=this.satAxes,o=this.alignedSatBounds;if(e.min=n.x,e.max=i.x,o[0].isSeparated(e)||(e.min=n.y,e.max=i.y,o[1].isSeparated(e))||(e.min=n.z,e.max=i.z,o[2].isSeparated(e)))return!1;for(let n=0;n<3;n++){let i=r[n],o=s[n];if(e.setFromBox(i,t),o.isSeparated(e))return!1}return!0}}(),O.prototype.intersectsTriangle=function(){let e=new F,t=[,,,],n=new I,i=new I,s=new h.Pa4;return function(r){this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(e.copy(r),e.update(),r=e);let o=this.satBounds,a=this.satAxes;t[0]=r.a,t[1]=r.b,t[2]=r.c;for(let e=0;e<3;e++){let i=o[e],s=a[e];if(n.setFromPoints(s,t),i.isSeparated(n))return!1}let l=r.satBounds,h=r.satAxes,c=this.points;for(let e=0;e<3;e++){let t=l[e],i=h[e];if(n.setFromPoints(i,c),t.isSeparated(n))return!1}for(let e=0;e<3;e++){let r=a[e];for(let e=0;e<4;e++){let o=h[e];if(s.crossVectors(r,o),n.setFromPoints(s,t),i.setFromPoints(s,c),n.isSeparated(i))return!1}}return!0}}(),O.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},O.prototype.distanceToPoint=function(){let e=new h.Pa4;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),O.prototype.distanceToBox=function(){let e=["x","y","z"],t=Array(12).fill().map(()=>new h.Zzh),n=Array(12).fill().map(()=>new h.Zzh),i=new h.Pa4,s=new h.Pa4;return function(r){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(r))return(a||l)&&(r.getCenter(s),this.closestPointToPoint(s,i),r.closestPointToPoint(i,s),a&&a.copy(i),l&&l.copy(s)),0;let h=o*o,c=r.min,u=r.max,d=this.points,p=1/0;for(let e=0;e<8;e++){let t=d[e];s.copy(t).clamp(c,u);let n=t.distanceToSquared(s);if(n<p&&(p=n,a&&a.copy(t),l&&l.copy(s),n<h))return Math.sqrt(n)}let m=0;for(let i=0;i<3;i++)for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=(i+1)%3,a=(i+2)%3,l=s<<o|r<<a,h=1<<i|s<<o|r<<a,p=d[l],f=d[h];t[m].set(p,f);let g=e[i],y=e[o],v=e[a],x=n[m],w=x.start,A=x.end;w[g]=c[g],w[y]=s?c[y]:u[y],w[v]=r?c[v]:u[y],A[g]=u[g],A[y]=s?c[y]:u[y],A[v]=r?c[v]:u[y],m++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){s.x=e?u.x:c.x,s.y=t?u.y:c.y,s.z=n?u.z:c.z,this.closestPointToPoint(s,i);let r=s.distanceToSquared(i);if(r<p&&(p=r,a&&a.copy(i),l&&l.copy(s),r<h))return Math.sqrt(r)}for(let e=0;e<12;e++){let r=t[e];for(let e=0;e<12;e++){L(r,n[e],i,s);let t=i.distanceToSquared(s);if(t<p&&(p=t,a&&a.copy(i),l&&l.copy(s),t<h))return Math.sqrt(t)}}return Math.sqrt(p)}}();class k{getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}constructor(e){this._getNewPrimitive=e,this._primitives=[]}}class D extends k{constructor(){super(()=>new F)}}let j=new D;class N{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;let e=[],t=null;this.setBuffer=n=>{t&&e.push(t),t=n,this.float32Array=new Float32Array(n),this.uint16Array=new Uint16Array(n),this.uint32Array=new Uint32Array(n)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}}let U=new N,H=[],K=new k(()=>new h.ZzF),z=new h.Pa4,X=new h.Pa4,$=new h.Pa4,Y=new h.Pa4,G=new h.Pa4,V=new h.FM8,Z=new h.FM8,Q=new h.FM8,q=new h.Pa4,W=new h.Pa4,J=new h.Pa4,ee=new h.Pa4;function et(e,t,n,i,s){let r=3*i,o=r+0,a=r+1,l=r+2,c=e.index;e.index&&(o=c.getX(o),a=c.getX(a),l=c.getX(l));let{position:u,normal:d,uv:p,uv1:m}=e.attributes,f=function(e,t,n,i,s,r,o,a,l){$.fromBufferAttribute(t,r),Y.fromBufferAttribute(t,o),G.fromBufferAttribute(t,a);let c=null===(l===h._Li?e.intersectTriangle(G,Y,$,!0,ee):e.intersectTriangle($,Y,G,l!==h.ehD,ee))?null:{distance:e.origin.distanceTo(ee),point:ee.clone()};if(c){i&&(V.fromBufferAttribute(i,r),Z.fromBufferAttribute(i,o),Q.fromBufferAttribute(i,a),c.uv=h.CJI.getInterpolation(ee,$,Y,G,V,Z,Q,new h.FM8)),s&&(V.fromBufferAttribute(s,r),Z.fromBufferAttribute(s,o),Q.fromBufferAttribute(s,a),c.uv1=h.CJI.getInterpolation(ee,$,Y,G,V,Z,Q,new h.FM8)),n&&(q.fromBufferAttribute(n,r),W.fromBufferAttribute(n,o),J.fromBufferAttribute(n,a),c.normal=h.CJI.getInterpolation(ee,$,Y,G,q,W,J,new h.Pa4),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let t={a:r,b:o,c:a,normal:new h.Pa4,materialIndex:0};h.CJI.getNormal($,Y,G,t.normal),c.face=t,c.faceIndex=r}return c}(n,u,d,p,m,o,a,l,t);return f?(f.faceIndex=i,s&&s.push(f),f):null}function en(e,t,n,i){let s=e.a,r=e.b,o=e.c,a=t,l=t+1,h=t+2;n&&(a=n.getX(a),l=n.getX(l),h=n.getX(h)),s.x=i.getX(a),s.y=i.getY(a),s.z=i.getZ(a),r.x=i.getX(l),r.y=i.getY(l),r.z=i.getZ(l),o.x=i.getX(h),o.y=i.getY(h),o.z=i.getZ(h)}function ei(e,t,n,i,s,r,o){let{geometry:a}=n,{index:l}=a,h=a.attributes.position;for(let n=e,a=t+e;n<a;n++){let e;if(en(o,3*(e=n),l,h),o.needsUpdate=!0,i(o,e,s,r))return!0}return!1}let es=new h.ZzF;function er(e,t,n,i){return g(e,t,es),n.intersectBox(es,i)}let eo=new h.Pa4;function ea(e,t,n,i,s){U.setBuffer(e._roots[t]),function e(t,n,i,s,r){let{float32Array:o,uint16Array:a,uint32Array:l}=U,h=2*t;if(M(h,a))!function(e,t,n,i,s,r){let{geometry:o,_indirectBuffer:a}=e;for(let e=i,a=i+s;e<a;e++)et(o,t,n,e,r)}(n,i,s,l[t+6],S(h,a),r);else{let a=t+8;er(a,o,s,eo)&&e(a,n,i,s,r);let h=l[t+6];er(h,o,s,eo)&&e(h,n,i,s,r)}}(0,e,n,i,s),U.clearBuffer()}let el=new h.Pa4,eh=["x","y","z"];function ec(e,t,n,i){U.setBuffer(e._roots[t]);let s=function e(t,n,i,s){let{float32Array:r,uint16Array:o,uint32Array:a}=U,l=2*t;if(M(l,o))return function(e,t,n,i,s){let{geometry:r,_indirectBuffer:o}=e,a=1/0,l=null;for(let e=i,o=i+s;e<o;e++){let i;(i=et(r,t,n,e))&&i.distance<a&&(l=i,a=i.distance)}return l}(n,i,s,a[t+6],S(l,o));{let o,l;let h=a[t+7],c=eh[h],u=s.direction[c]>=0;u?(o=t+8,l=a[t+6]):(o=a[t+6],l=t+8);let d=er(o,r,s,el)?e(o,n,i,s):null;if(d){let e=d.point[c];if(u?e<=r[l+h]:e>=r[l+h+3])return d}let p=er(l,r,s,el)?e(l,n,i,s):null;return d&&p?d.distance<=p.distance?d:p:d||p||null}}(0,e,n,i);return U.clearBuffer(),s}let eu=new h.ZzF,ed=new F,ep=new F,em=new h.yGw,ef=new O,eg=new O;function ey(e,t,n,i){U.setBuffer(e._roots[t]);let s=function e(t,n,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,{float32Array:o,uint16Array:a,uint32Array:l}=U,h=2*t;if(null===r&&(i.boundingBox||i.computeBoundingBox(),ef.set(i.boundingBox.min,i.boundingBox.max,s),r=ef),M(h,a)){let e=n.geometry,r=e.index,c=e.attributes.position,u=i.index,d=i.attributes.position,p=l[t+6],m=S(h,a);if(em.copy(s).invert(),i.boundsTree)return g(t,o,eg),eg.matrix.copy(em),eg.needsUpdate=!0,i.boundsTree.shapecast({intersectsBounds:e=>eg.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let t=3*p,n=(m+p)*3;t<n;t+=3)if(en(ep,t,r,c),ep.needsUpdate=!0,e.intersectsTriangle(ep))return!0;return!1}});for(let e=3*p,t=(m+p)*3;e<t;e+=3){en(ed,e,r,c),ed.a.applyMatrix4(em),ed.b.applyMatrix4(em),ed.c.applyMatrix4(em),ed.needsUpdate=!0;for(let e=0,t=u.count;e<t;e+=3)if(en(ep,e,u,d),ep.needsUpdate=!0,ed.intersectsTriangle(ep))return!0}}else{let a=t+8,h=l[t+6];return g(a,o,eu),!!(r.intersectsBox(eu)&&e(a,n,i,s,r))||(g(h,o,eu),!!(r.intersectsBox(eu)&&e(h,n,i,s,r)))}}(0,e,n,i);return U.clearBuffer(),s}let ev=new h.yGw,ex=new O,ew=new O,eA=new h.Pa4,eb=new h.Pa4,eE=new h.Pa4,eT=new h.Pa4;function e_(e,t,n,i,s,r,o){let{geometry:a}=n,{index:l}=a,h=a.attributes.position;for(let a=e,c=t+e;a<c;a++){let e;if(en(o,3*(e=n.resolveTriangleIndex(a)),l,h),o.needsUpdate=!0,i(o,e,s,r))return!0}return!1}let eP=new h.Pa4;function eM(e,t,n,i,s){U.setBuffer(e._roots[t]),function e(t,n,i,s,r){let{float32Array:o,uint16Array:a,uint32Array:l}=U,h=2*t;if(M(h,a))!function(e,t,n,i,s,r){let{geometry:o,_indirectBuffer:a}=e;for(let e=i,l=i+s;e<l;e++)et(o,t,n,a?a[e]:e,r)}(n,i,s,l[t+6],S(h,a),r);else{let a=t+8;er(a,o,s,eP)&&e(a,n,i,s,r);let h=l[t+6];er(h,o,s,eP)&&e(h,n,i,s,r)}}(0,e,n,i,s),U.clearBuffer()}let eS=new h.Pa4,eI=["x","y","z"];function eR(e,t,n,i){U.setBuffer(e._roots[t]);let s=function e(t,n,i,s){let{float32Array:r,uint16Array:o,uint32Array:a}=U,l=2*t;if(M(l,o))return function(e,t,n,i,s){let{geometry:r,_indirectBuffer:o}=e,a=1/0,l=null;for(let e=i,h=i+s;e<h;e++){let i;(i=et(r,t,n,o?o[e]:e))&&i.distance<a&&(l=i,a=i.distance)}return l}(n,i,s,a[t+6],S(l,o));{let o,l;let h=a[t+7],c=eI[h],u=s.direction[c]>=0;u?(o=t+8,l=a[t+6]):(o=a[t+6],l=t+8);let d=er(o,r,s,eS)?e(o,n,i,s):null;if(d){let e=d.point[c];if(u?e<=r[l+h]:e>=r[l+h+3])return d}let p=er(l,r,s,eS)?e(l,n,i,s):null;return d&&p?d.distance<=p.distance?d:p:d||p||null}}(0,e,n,i);return U.clearBuffer(),s}let eL=new h.ZzF,eC=new F,eB=new F,eF=new h.yGw,eO=new O,ek=new O;function eD(e,t,n,i){U.setBuffer(e._roots[t]);let s=function e(t,n,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,{float32Array:o,uint16Array:a,uint32Array:l}=U,h=2*t;if(null===r&&(i.boundingBox||i.computeBoundingBox(),eO.set(i.boundingBox.min,i.boundingBox.max,s),r=eO),M(h,a)){let e=n.geometry,r=e.index,c=e.attributes.position,u=i.index,d=i.attributes.position,p=l[t+6],m=S(h,a);if(eF.copy(s).invert(),i.boundsTree)return g(t,o,ek),ek.matrix.copy(eF),ek.needsUpdate=!0,i.boundsTree.shapecast({intersectsBounds:e=>ek.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let t=p,i=m+p;t<i;t++)if(en(eB,3*n.resolveTriangleIndex(t),r,c),eB.needsUpdate=!0,e.intersectsTriangle(eB))return!0;return!1}});for(let e=p,t=m+p;e<t;e++){en(eC,3*n.resolveTriangleIndex(e),r,c),eC.a.applyMatrix4(eF),eC.b.applyMatrix4(eF),eC.c.applyMatrix4(eF),eC.needsUpdate=!0;for(let e=0,t=u.count;e<t;e+=3)if(en(eB,e,u,d),eB.needsUpdate=!0,eC.intersectsTriangle(eB))return!0}}else{let a=t+8,h=l[t+6];return g(a,o,eL),!!(r.intersectsBox(eL)&&e(a,n,i,s,r))||(g(h,o,eL),!!(r.intersectsBox(eL)&&e(h,n,i,s,r)))}}(0,e,n,i);return U.clearBuffer(),s}let ej=new h.yGw,eN=new O,eU=new O,eH=new h.Pa4,eK=new h.Pa4,ez=new h.Pa4,eX=new h.Pa4,e$=new U.constructor,eY=new U.constructor,eG=new k(()=>new h.ZzF),eV=new h.ZzF,eZ=new h.ZzF,eQ=new h.ZzF,eq=new h.ZzF,eW=!1,eJ=new O,e0=new h.ZzF,e1={strategy:0,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class e2{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t={cloneBuffers:!0,...t};let n=e.geometry,i=e._roots,s=e._indirectBuffer,r=n.getIndex();return t.cloneBuffers?{roots:i.map(e=>e.slice()),index:r.array.slice(),indirectBuffer:s?s.slice():null}:{roots:i,index:r.array,indirectBuffer:s}}static deserialize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n={setIndex:!0,indirect:!!e.indirectBuffer,...n};let{index:i,roots:s,indirectBuffer:r}=e,o=new e2(t,{...n,[u]:!0});if(o._roots=s,o._indirectBuffer=r||null,n.setIndex){let n=t.getIndex();if(null===n){let n=new h.TlE(e.index,1,!1);t.setIndex(n)}else n.array!==i&&(n.array.set(i),n.needsUpdate=!0)}return o}get indirect(){return!!this._indirectBuffer}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(this.indirect?function(e){let t,n,i,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r&&Array.isArray(r)&&(r=new Set(r));let o=e.geometry,a=o.index?o.index.array:null,l=o.attributes.position,h=0,c=e._roots;for(let o=0,u=c.length;o<u;o++)t=c[o],n=new Uint32Array(t),i=new Uint16Array(t),s=new Float32Array(t),function t(o,h){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=2*o;if(65535===i[u+15]){let t=n[o+6],r=i[u+14],h=1/0,c=1/0,d=1/0,p=-1/0,m=-1/0,f=-1/0;for(let n=t,i=t+r;n<i;n++){let t=3*e.resolveTriangleIndex(n);for(let e=0;e<3;e++){let n=t+e;n=a?a[n]:n;let i=l.getX(n),s=l.getY(n),r=l.getZ(n);i<h&&(h=i),i>p&&(p=i),s<c&&(c=s),s>m&&(m=s),r<d&&(d=r),r>f&&(f=r)}}return(s[o+0]!==h||s[o+1]!==c||s[o+2]!==d||s[o+3]!==p||s[o+4]!==m||s[o+5]!==f)&&(s[o+0]=h,s[o+1]=c,s[o+2]=d,s[o+3]=p,s[o+4]=m,s[o+5]=f,!0)}{let e=o+8,i=n[o+6],a=c,l=!1,u=!1;r?a||(l=r.has(e+h),u=r.has(i+h),a=!l&&!u):(l=!0,u=!0);let d=a||l,p=a||u,m=!1;d&&(m=t(e,h,a));let f=!1;p&&(f=t(i,h,a));let g=m||f;if(g)for(let t=0;t<3;t++){let n=e+t,r=i+t,a=s[n],l=s[n+3],h=s[r],c=s[r+3];s[o+t]=a<h?a:h,s[o+t+3]=l>c?l:c}return g}}(0,h),h+=t.byteLength}:function(e){let t,n,i,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r&&Array.isArray(r)&&(r=new Set(r));let o=e.geometry,a=o.index?o.index.array:null,l=o.attributes.position,h=0,c=e._roots;for(let e=0,o=c.length;e<o;e++)t=c[e],n=new Uint32Array(t),i=new Uint16Array(t),s=new Float32Array(t),function e(t,o){let h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=2*t;if(65535===i[c+15]){let e=n[t+6],r=i[c+14],o=1/0,h=1/0,u=1/0,d=-1/0,p=-1/0,m=-1/0;for(let t=3*e,n=3*(e+r);t<n;t++){let e=a[t],n=l.getX(e),i=l.getY(e),s=l.getZ(e);n<o&&(o=n),n>d&&(d=n),i<h&&(h=i),i>p&&(p=i),s<u&&(u=s),s>m&&(m=s)}return(s[t+0]!==o||s[t+1]!==h||s[t+2]!==u||s[t+3]!==d||s[t+4]!==p||s[t+5]!==m)&&(s[t+0]=o,s[t+1]=h,s[t+2]=u,s[t+3]=d,s[t+4]=p,s[t+5]=m,!0)}{let i=t+8,a=n[t+6],l=h,c=!1,u=!1;r?l||(c=r.has(i+o),u=r.has(a+o),l=!c&&!u):(c=!0,u=!0);let d=l||c,p=l||u,m=!1;d&&(m=e(i,o,l));let f=!1;p&&(f=e(a,o,l));let g=m||f;if(g)for(let e=0;e<3;e++){let n=i+e,r=a+e,o=s[n],l=s[n+3],h=s[r],c=s[r+3];s[t+e]=o<h?o:h,s[t+e+3]=l>c?l:c}return g}}(0,h),h+=t.byteLength})(this,e)}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots[t],i=new Uint32Array(n),s=new Uint16Array(n);!function t(r){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=2*r,l=65535===s[a+15];if(l){let t=i[r+6],h=s[a+14];e(o,l,new Float32Array(n,4*r,6),t,h)}else{let s=i[r+6],a=i[r+7];e(o,l,new Float32Array(n,4*r,6),a)||(t(r+8,o+1),t(s,o+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.Wl3,n=this._roots,i=this.geometry,s=[],r=t.isMaterial,o=Array.isArray(t),a=i.groups,l=r?t.side:t,c=this.indirect?eM:ea;for(let i=0,r=n.length;i<r;i++){let n=o?t[a[i].materialIndex].side:l,r=s.length;if(c(this,i,n,e,s),o){let e=a[i].materialIndex;for(let t=r,n=s.length;t<n;t++)s[t].face.materialIndex=e}}return s}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.Wl3,n=this._roots,i=this.geometry,s=t.isMaterial,r=Array.isArray(t),o=null,a=i.groups,l=s?t.side:t,c=this.indirect?eR:ec;for(let i=0,s=n.length;i<s;i++){let n=r?t[a[i].materialIndex].side:l,s=c(this,i,n,e);null!=s&&(null==o||s.distance<o.distance)&&(o=s,r&&(s.face.materialIndex=a[i].materialIndex))}return o}intersectsGeometry(e,t){let n=!1,i=this._roots,s=this.indirect?eD:ey;for(let r=0,o=i.length;r<o&&!(n=s(this,r,e,t));r++);return n}shapecast(e){let t=j.getPrimitive(),n=this.indirect?e_:ei,{boundsTraverseOrder:i,intersectsBounds:s,intersectsRange:r,intersectsTriangle:o}=e;if(r&&o){let e=r;r=(i,s,r,a,l)=>!!e(i,s,r,a,l)||n(i,s,this,o,r,a,t)}else r||(r=o?(e,i,s,r)=>n(e,i,this,o,s,r,t):(e,t,n)=>n);let h=!1,c=0,u=this._roots;for(let e=0,t=u.length;e<t;e++){let t=u[e];if(h=function(e,t,n,i,s,r){a=K.getPrimitive(),l=K.getPrimitive(),H.push(a,l),U.setBuffer(e._roots[t]);let o=function e(t,n,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,{float32Array:c,uint16Array:u,uint32Array:d}=U,p=2*t;if(M(p,u)){let e=d[t+6],n=S(p,u);return g(t,c,a),s(e,n,!1,h,o+t,a)}{let p,y,v,x,w,A;let b=t+8,E=d[t+6],T=b,_=E;if(r&&(v=a,x=l,g(T,c,v),g(_,c,x),p=r(v),(y=r(x))<p)){T=E,_=b;let e=p;p=y,y=e,v=x}v||g(T,c,v=a);let P=i(v,M(2*T,u),p,h+1,o+T);if(2===P){let e=m(T);w=s(e,f(T)-e,!0,h+1,o+T,v)}else w=P&&e(T,n,i,s,r,o,h+1);if(w)return!0;g(_,c,x=l);let I=i(x,M(2*_,u),y,h+1,o+_);if(2===I){let e=m(_);A=s(e,f(_)-e,!0,h+1,o+_,x)}else A=I&&e(_,n,i,s,r,o,h+1);if(A)return!0;return!1;function m(e){let{uint16Array:t,uint32Array:n}=U,i=2*e;for(;!M(i,t);)e+=8,i=2*e;return n[e+6]}function f(e){let{uint16Array:t,uint32Array:n}=U,i=2*e;for(;!M(i,t);)i=2*(e=n[e+6]);return n[e+6]+S(i,t)}}}(0,e.geometry,n,i,s,r);U.clearBuffer(),K.releasePrimitive(a),K.releasePrimitive(l),H.pop(),H.pop();let h=H.length;return h>0&&(l=H[h-1],a=H[h-2]),o}(this,e,s,r,i,c))break;c+=t.byteLength}return j.releasePrimitive(t),h}bvhcast(e,t,n){let{intersectsRanges:i,intersectsTriangles:s}=n,r=j.getPrimitive(),o=this.geometry.index,a=this.geometry.attributes.position,l=this.indirect?e=>{en(r,3*this.resolveTriangleIndex(e),o,a)}:e=>{en(r,3*e,o,a)},c=j.getPrimitive(),u=e.geometry.index,d=e.geometry.attributes.position,p=e.indirect?t=>{en(c,3*e.resolveTriangleIndex(t),u,d)}:e=>{en(c,3*e,u,d)};if(s){let e=(e,n,i,o,a,h,u,d)=>{for(let m=i,f=i+o;m<f;m++){p(m),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,i=e+n;t<i;t++)if(l(t),r.needsUpdate=!0,s(r,c,t,m,a,h,u,d))return!0}return!1};if(i){let t=i;i=function(n,i,s,r,o,a,l,h){return!!t(n,i,s,r,o,a,l,h)||e(n,i,s,r,o,a,l,h)}}else i=e}return function(e,t,n,i){let s;if(eW)throw Error("MeshBVH: Recursive calls to bvhcast not supported.");eW=!0;let r=e._roots,o=t._roots,a=0,l=0,c=new h.yGw().copy(n).invert();for(let e=0,t=r.length;e<t;e++){e$.setBuffer(r[e]),l=0;let t=eG.getPrimitive();g(0,e$.float32Array,t),t.applyMatrix4(c);for(let r=0,h=o.length;r<h&&(eY.setBuffer(o[e]),s=function e(t,n,i,s,r){let o,a,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,p=arguments.length>10&&void 0!==arguments[10]&&arguments[10];p?(o=eY,a=e$):(o=e$,a=eY);let m=o.float32Array,f=o.uint32Array,y=o.uint16Array,v=a.float32Array,x=a.uint32Array,w=a.uint16Array,A=2*n,b=M(2*t,y),E=M(A,w),T=!1;if(E&&b)T=p?r(x[n+6],S(2*n,w),f[t+6],S(2*t,y),u,h+n,c,l+t):r(f[t+6],S(2*t,y),x[n+6],S(2*n,w),c,l+t,u,h+n);else if(E){let o=eG.getPrimitive();g(n,v,o),o.applyMatrix4(i);let a=t+8,d=f[t+6];g(a,m,eV),g(d,m,eZ);let y=o.intersectsBox(eV),x=o.intersectsBox(eZ);T=y&&e(n,a,s,i,r,h,l,u,c+1,o,!p)||x&&e(n,d,s,i,r,h,l,u,c+1,o,!p),eG.releasePrimitive(o)}else{let o=n+8,a=x[n+6];g(o,v,eQ),g(a,v,eq);let y=d.intersectsBox(eQ),w=d.intersectsBox(eq);if(y&&w)T=e(t,o,i,s,r,l,h,c,u+1,d,p)||e(t,a,i,s,r,l,h,c,u+1,d,p);else if(y){if(b)T=e(t,o,i,s,r,l,h,c,u+1,d,p);else{let n=eG.getPrimitive();n.copy(eQ).applyMatrix4(i);let a=t+8,d=f[t+6];g(a,m,eV),g(d,m,eZ);let y=n.intersectsBox(eV),v=n.intersectsBox(eZ);T=y&&e(o,a,s,i,r,h,l,u,c+1,n,!p)||v&&e(o,d,s,i,r,h,l,u,c+1,n,!p),eG.releasePrimitive(n)}}else if(w){if(b)T=e(t,a,i,s,r,l,h,c,u+1,d,p);else{let n=eG.getPrimitive();n.copy(eq).applyMatrix4(i);let o=t+8,d=f[t+6];g(o,m,eV),g(d,m,eZ);let y=n.intersectsBox(eV),v=n.intersectsBox(eZ);T=y&&e(a,o,s,i,r,h,l,u,c+1,n,!p)||v&&e(a,d,s,i,r,h,l,u,c+1,n,!p),eG.releasePrimitive(n)}}}return T}(0,0,n,c,i,a,l,0,0,t),eY.clearBuffer(),l+=o[r].length,!s);r++);if(eG.releasePrimitive(t),e$.clearBuffer(),a+=r[e].length,s)break}return eW=!1,s}(this,e,t,i)}intersectsBox(e,t){return eJ.set(e.min,e.max,t),eJ.needsUpdate=!0,this.shapecast({intersectsBounds:e=>eJ.intersectsBox(e),intersectsTriangle:e=>eJ.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;return(this.indirect?function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),eN.set(t.boundingBox.min,t.boundingBox.max,n),eN.needsUpdate=!0;let a=e.geometry,l=a.attributes.position,h=a.index,c=t.attributes.position,u=t.index,p=j.getPrimitive(),m=j.getPrimitive(),f=null,g=null;s&&(f=ez,g=eX);let y=1/0,v=null,x=null;return(ej.copy(n).invert(),eU.matrix.copy(ej),e.shapecast({boundsTraverseOrder:e=>eN.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<o&&(t&&(eU.min.copy(e.min),eU.max.copy(e.max),eU.needsUpdate=!0),!0),intersectsRange:(i,s)=>{if(t.boundsTree){let a=t.boundsTree;return a.shapecast({boundsTraverseOrder:e=>eU.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<o,intersectsRange:(t,o)=>{for(let d=t,w=t+o;d<w;d++){en(m,3*a.resolveTriangleIndex(d),u,c),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let t=i,n=i+s;t<n;t++){en(p,3*e.resolveTriangleIndex(t),h,l),p.needsUpdate=!0;let n=p.distanceToTriangle(m,eH,f);if(n<y&&(eK.copy(eH),g&&g.copy(f),y=n,v=t,x=d),n<r)return!0}}}})}{let o=d(t);for(let t=0;t<o;t++){en(m,3*t,u,c),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let n=i,o=i+s;n<o;n++){en(p,3*e.resolveTriangleIndex(n),h,l),p.needsUpdate=!0;let i=p.distanceToTriangle(m,eH,f);if(i<y&&(eK.copy(eH),g&&g.copy(f),y=i,v=n,x=t),i<r)return!0}}}}}),j.releasePrimitive(p),j.releasePrimitive(m),y===1/0)?null:(i.point?i.point.copy(eK):i.point=eK.clone(),i.distance=y,i.faceIndex=v,s&&(s.point?s.point.copy(g):s.point=g.clone(),s.point.applyMatrix4(ej),eK.applyMatrix4(ej),s.distance=eK.sub(s.point).length(),s.faceIndex=x),i)}:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),ex.set(t.boundingBox.min,t.boundingBox.max,n),ex.needsUpdate=!0;let a=e.geometry,l=a.attributes.position,h=a.index,c=t.attributes.position,u=t.index,p=j.getPrimitive(),m=j.getPrimitive(),f=null,g=null;s&&(f=eE,g=eT);let y=1/0,v=null,x=null;return(ev.copy(n).invert(),ew.matrix.copy(ev),e.shapecast({boundsTraverseOrder:e=>ex.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<o&&(t&&(ew.min.copy(e.min),ew.max.copy(e.max),ew.needsUpdate=!0),!0),intersectsRange:(e,i)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>ew.distanceToBox(e),intersectsBounds:(e,t,n)=>n<y&&n<o,intersectsRange:(t,s)=>{for(let o=t,a=t+s;o<a;o++){en(m,3*o,u,c),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let t=e,n=e+i;t<n;t++){en(p,3*t,h,l),p.needsUpdate=!0;let e=p.distanceToTriangle(m,eA,f);if(e<y&&(eb.copy(eA),g&&g.copy(f),y=e,v=t,x=o),e<r)return!0}}}});{let s=d(t);for(let t=0;t<s;t++){en(m,3*t,u,c),m.a.applyMatrix4(n),m.b.applyMatrix4(n),m.c.applyMatrix4(n),m.needsUpdate=!0;for(let n=e,s=e+i;n<s;n++){en(p,3*n,h,l),p.needsUpdate=!0;let e=p.distanceToTriangle(m,eA,f);if(e<y&&(eb.copy(eA),g&&g.copy(f),y=e,v=n,x=t),e<r)return!0}}}}}),j.releasePrimitive(p),j.releasePrimitive(m),y===1/0)?null:(i.point?i.point.copy(eb):i.point=eb.clone(),i.distance=y,i.faceIndex=v,s&&(s.point?s.point.copy(g):s.point=g.clone(),s.point.applyMatrix4(ev),eb.applyMatrix4(ev),s.distance=eb.sub(s.point).length(),s.faceIndex=x),i)})(this,e,t,n,i,s,r)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,r=i*i,o=s*s,a=1/0,l=null;if(e.shapecast({boundsTraverseOrder:e=>(z.copy(t).clamp(e.min,e.max),z.distanceToSquared(t)),intersectsBounds:(e,t,n)=>n<a&&n<o,intersectsTriangle:(e,n)=>{e.closestPointToPoint(t,z);let i=t.distanceToSquared(z);return i<a&&(X.copy(z),a=i,l=n),i<r}}),a===1/0)return null;let h=Math.sqrt(a);return n.point?n.point.copy(X):n.point=X.clone(),n.distance=h,n.faceIndex=l,n}(this,e,t,n,i)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{g(0,new Float32Array(t),e0),e.union(e0)}),e}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw Error("MeshBVH: Only BufferGeometries are supported.");if((t=Object.assign({...e1,[u]:!1},t)).useSharedArrayBuffer&&!("undefined"!=typeof SharedArrayBuffer))throw Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[u]||(function(e,t){let n=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){let n=(e.index?e.index.count:e.attributes.position.count)/3,i=n>65536,s=i?4:2,r=t?new SharedArrayBuffer(n*s):new ArrayBuffer(n*s),o=i?new Uint32Array(r):new Uint16Array(r);for(let e=0,t=o.length;e<t;e++)o[e]=e;return o}(n,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;let t=d(e),n=m(e).sort((e,t)=>e.offset-t.offset),i=n[n.length-1];i.count=Math.min(t-i.offset,i.count);let s=0;return n.forEach(e=>{let{count:t}=e;return s+=t}),t!==s}(n)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||function(e,t){if(!e.index){let n=e.attributes.position.count,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ArrayBuffer;return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}(n,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new h.TlE(i,1));for(let e=0;e<n;e++)i[e]=e}}(n,t);let a=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,l=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.attributes.position,o=e.index?e.index.array:null,a=d(e),l=r.normalized;null===n?(t=new Float32Array(24*a),i=0,s=a):(t=n,i=i||0,s=s||a);let h=r.array,c=r.offset||0,u=3;r.isInterleavedBufferAttribute&&(u=r.data.stride);let p=["getX","getY","getZ"];for(let e=i;e<i+s;e++){let n=3*e,i=6*e,s=n+0,a=n+1,d=n+2;o&&(s=o[s],a=o[a],d=o[d]),l||(s=s*u+c,a=a*u+c,d=d*u+c);for(let e=0;e<3;e++){let n,o,c;l?(n=r[p[e]](s),o=r[p[e]](a),c=r[p[e]](d)):(n=h[s+e],o=h[a+e],c=h[d+e]);let u=n;o<u&&(u=o),c<u&&(u=c);let m=n;o>m&&(m=o),c>m&&(m=c);let f=(m-u)/2,g=2*e;t[i+g+0]=u+f,t[i+g+1]=f+(Math.abs(u)+f)*5960464477539063e-23}}return t}(n),c=t.indirect?p(n):m(n);e._roots=c.map(n=>{let h=function(e,t,n,i,s){let{maxDepth:r,verbose:o,maxLeafTris:a,strategy:l,onProgress:h,indirect:c}=s,u=e._indirectBuffer,p=e.geometry,m=p.index?p.index.array:null,g=c?P:_,M=d(p),S=new Float32Array(6),I=!1,R=new T;return f(t,n,i,R.boundingData,S),function e(n,i,s){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!I&&c>=r&&(I=!0,o&&(console.warn("MeshBVH: Max depth of ".concat(r," reached when generating BVH. Consider increasing maxDepth.")),console.warn(p))),s<=a||c>=r)return L(i+s),n.offset=i,n.count=s,n;let d=function(e,t,n,i,s,r){let o=-1,a=0;if(0===r)-1!==(o=y(t))&&(a=(t[o]+t[o+3])/2);else if(1===r)-1!==(o=y(e))&&(a=function(e,t,n,i){let s=0;for(let r=t,o=t+n;r<o;r++)s+=e[6*r+2*i];return s/n}(n,i,s,o));else if(2===r){let r=w(e),l=1.25*s,h=6*i,c=(i+s)*6;for(let e=0;e<3;e++){let i=t[e],u=(t[e+3]-i)/32;if(s<8){let t=[...b];t.length=s;let i=0;for(let s=h;s<c;s+=6,i++){let r=t[i];r.candidate=n[s+2*e],r.count=0;let{bounds:o,leftCacheBounds:a,rightCacheBounds:l}=r;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0;x(s,n,o)}t.sort(A);let u=s;for(let e=0;e<u;e++){let n=t[e];for(;e+1<u&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),u--}for(let i=h;i<c;i+=6){let s=n[i+2*e];for(let e=0;e<u;e++){let r=t[e];s>=r.candidate?x(i,n,r.rightCacheBounds):(x(i,n,r.leftCacheBounds),r.count++)}}for(let n=0;n<u;n++){let i=t[n],h=i.count,c=s-i.count,u=i.leftCacheBounds,d=i.rightCacheBounds,p=0;0!==h&&(p=w(u)/r);let m=0;0!==c&&(m=w(d)/r);let f=1+1.25*(p*h+m*c);f<l&&(o=e,l=f,a=i.candidate)}}else{for(let e=0;e<32;e++){let t=b[e];t.count=0,t.candidate=i+u+e*u;let n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let t=h;t<c;t+=6){let s=~~((n[t+2*e]-i)/u);s>=32&&(s=31);let r=b[s];r.count++,x(t,n,r.bounds)}let t=b[31];!function(e,t){t.set(e)}(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=b[e],n=b[e+1];v(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let t=0;t<31;t++){let n=b[t],i=n.count,h=n.bounds,c=b[t+1].rightCacheBounds;0!==i&&(0===d?function(e,t){t.set(e)}(h,E):v(h,E,E));let u=0,p=0;0!==(d+=i)&&(u=w(E)/r);let m=s-d;0!==m&&(p=w(c)/r);let f=1+1.25*(u*d+p*m);f<l&&(o=e,l=f,a=n.candidate)}}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(r," used."));return{axis:o,pos:a}}(n.boundingData,h,t,i,s,l);if(-1===d.axis)return L(i+s),n.offset=i,n.count=s,n;let _=g(u,m,t,i,s,d);if(_===i||_===i+s)L(i+s),n.offset=i,n.count=s;else{n.splitAxis=d.axis;let r=new T,o=_-i;n.left=r,f(t,i,o,r.boundingData,S),e(r,i,o,S,c+1);let a=new T,l=s-o;n.right=a,f(t,_,l,a.boundingData,S),e(a,_,l,S,c+1)}return n}(R,n,i,S),R;function L(e){h&&h(e/M)}}(e,l,n.offset,n.count,t),c=new a(32*function e(t){return"count"in t?1:1+e(t.left)+e(t.right)}(h));return i=new Float32Array(c),s=new Uint32Array(c),r=new Uint16Array(c),o=new Uint8Array(c),function e(t,n){let a=t/4,l=t/2,h=n.boundingData;for(let e=0;e<6;e++)i[a+e]=h[e];if("count"in n){if(n.buffer){let e=n.buffer;o.set(new Uint8Array(e),t);for(let n=t,i=t+e.byteLength;n<i;n+=32)M(n/2,r)||(s[n/4+6]+=a);return t+e.byteLength}{let e=n.offset,i=n.count;return s[a+6]=e,r[l+14]=i,r[l+15]=65535,t+32}}{let i;let r=n.left,o=n.right,l=n.splitAxis;if((i=e(t+32,r))/4>4294967296)throw Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[a+6]=i/4,i=e(i,o),s[a+7]=l,i}}(0,h),c})}(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new h.ZzF)));let{_indirectBuffer:n}=this;this.resolveTriangleIndex=t.indirect?e=>n[e]:e=>e}}let e4=new h.zHn,e3=new h.yGw,e5=h.Kj0.prototype.raycast;function e6(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;e3.copy(this.matrixWorld).invert(),e4.copy(e.ray).applyMatrix4(e3);let n=this.geometry.boundsTree;if(!0===e.firstHitOnly){let i=c(n.raycastFirst(e4,this.material),this,e);i&&t.push(i)}else{let i=n.raycast(e4,this.material);for(let n=0,s=i.length;n<s;n++){let s=c(i[n],this,e);s&&t.push(s)}}}else e5.call(this,e,t)}function e8(e){return this.boundsTree=new e2(this,e),this.boundsTree}function e7(){this.boundsTree=null}},6967:function(e,t,n){n.d(t,{z:function(){return c}});var i=n(6376);let s={type:"change"},r={type:"start"},o={type:"end"},a=new i.zHn,l=new i.JOQ,h=Math.cos(70*i.M8C.DEG2RAD);class c extends i.pBf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new i.Pa4,this.cursor=new i.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:i.RsA.ROTATE,MIDDLE:i.RsA.DOLLY,RIGHT:i.RsA.PAN},this.touches={ONE:i.QmN.ROTATE,TWO:i.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",et),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",et),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),u=c.NONE},this.update=function(){let t=new i.Pa4,r=new i._fP().setFromUnitVectors(e.up,new i.Pa4(0,1,0)),o=r.clone().invert(),y=new i.Pa4,v=new i._fP,x=new i.Pa4,w=2*Math.PI;return function(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=n.object.position;t.copy(b).sub(n.target),t.applyQuaternion(r),p.setFromVector3(t),n.autoRotate&&u===c.NONE&&B(null!==A?2*Math.PI/60*n.autoRotateSpeed*A:2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(p.theta+=m.theta*n.dampingFactor,p.phi+=m.phi*n.dampingFactor):(p.theta+=m.theta,p.phi+=m.phi);let E=n.minAzimuthAngle,T=n.maxAzimuthAngle;isFinite(E)&&isFinite(T)&&(E<-Math.PI?E+=w:E>Math.PI&&(E-=w),T<-Math.PI?T+=w:T>Math.PI&&(T-=w),E<=T?p.theta=Math.max(E,Math.min(T,p.theta)):p.theta=p.theta>(E+T)/2?Math.max(E,p.theta):Math.min(T,p.theta)),p.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,p.phi)),p.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(g,n.dampingFactor):n.target.add(g),n.target.sub(n.cursor),n.target.clampLength(n.minTargetRadius,n.maxTargetRadius),n.target.add(n.cursor),n.zoomToCursor&&S||n.object.isOrthographicCamera?p.radius=H(p.radius):p.radius=H(p.radius*f),t.setFromSpherical(p),t.applyQuaternion(o),b.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(m.theta*=1-n.dampingFactor,m.phi*=1-n.dampingFactor,g.multiplyScalar(1-n.dampingFactor)):(m.set(0,0,0),g.set(0,0,0));let _=!1;if(n.zoomToCursor&&S){let s=null;if(n.object.isPerspectiveCamera){let e=t.length();s=H(e*f);let i=e-s;n.object.position.addScaledVector(P,i),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){let e=new i.Pa4(M.x,M.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix(),_=!0;let r=new i.Pa4(M.x,M.y,0);r.unproject(n.object),n.object.position.sub(r).add(e),n.object.updateMatrixWorld(),s=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==s&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(s).add(n.object.position):(a.origin.copy(n.object.position),a.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(a.direction))<h?e.lookAt(n.target):(l.setFromNormalAndCoplanarPoint(n.object.up,n.target),a.intersectPlane(l,n.target))))}else n.object.isOrthographicCamera&&(_=1!==f)&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix());return f=1,S=!1,!!(_||y.distanceToSquared(n.object.position)>d||8*(1-v.dot(n.object.quaternion))>d||x.distanceToSquared(n.target)>0)&&(n.dispatchEvent(s),y.copy(n.object.position),v.copy(n.object.quaternion),x.copy(n.target),!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ei),n.domElement.removeEventListener("pointerdown",Q),n.domElement.removeEventListener("pointercancel",W),n.domElement.removeEventListener("wheel",J),n.domElement.removeEventListener("pointermove",q),n.domElement.removeEventListener("pointerup",W),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",et),n._domElementKeyEvents=null)};let n=this,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u=c.NONE,d=1e-6,p=new i.$V,m=new i.$V,f=1,g=new i.Pa4,y=new i.FM8,v=new i.FM8,x=new i.FM8,w=new i.FM8,A=new i.FM8,b=new i.FM8,E=new i.FM8,T=new i.FM8,_=new i.FM8,P=new i.Pa4,M=new i.FM8,S=!1,I=[],R={},L=!1;function C(e){return Math.pow(.95,n.zoomSpeed*Math.abs(.01*e))}function B(e){m.theta-=e}function F(e){m.phi-=e}let O=function(){let e=new i.Pa4;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),g.add(e)}}(),k=function(){let e=new i.Pa4;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),D=function(){let e=new i.Pa4;return function(t,i){let s=n.domElement;if(n.object.isPerspectiveCamera){let r=n.object.position;e.copy(r).sub(n.target);let o=e.length();O(2*t*(o*=Math.tan(n.object.fov/2*Math.PI/180))/s.clientHeight,n.object.matrix),k(2*i*o/s.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(O(t*(n.object.right-n.object.left)/n.object.zoom/s.clientWidth,n.object.matrix),k(i*(n.object.top-n.object.bottom)/n.object.zoom/s.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function j(e){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?f/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(e){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?f*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function U(e,t){if(!n.zoomToCursor)return;S=!0;let i=n.domElement.getBoundingClientRect(),s=e-i.left,r=t-i.top,o=i.width,a=i.height;M.x=s/o*2-1,M.y=-(r/a*2)+1,P.set(M.x,M.y,1).unproject(n.object).sub(n.object.position).normalize()}function H(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function K(e){y.set(e.clientX,e.clientY)}function z(e){w.set(e.clientX,e.clientY)}function X(e){if(1===I.length)y.set(e.pageX,e.pageY);else{let t=er(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);y.set(n,i)}}function $(e){if(1===I.length)w.set(e.pageX,e.pageY);else{let t=er(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);w.set(n,i)}}function Y(e){let t=er(e),n=e.pageX-t.x,i=e.pageY-t.y;E.set(0,Math.sqrt(n*n+i*i))}function G(e){if(1==I.length)v.set(e.pageX,e.pageY);else{let t=er(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);v.set(n,i)}x.subVectors(v,y).multiplyScalar(n.rotateSpeed);let t=n.domElement;B(2*Math.PI*x.x/t.clientHeight),F(2*Math.PI*x.y/t.clientHeight),y.copy(v)}function V(e){if(1===I.length)A.set(e.pageX,e.pageY);else{let t=er(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);A.set(n,i)}b.subVectors(A,w).multiplyScalar(n.panSpeed),D(b.x,b.y),w.copy(A)}function Z(e){let t=er(e),i=e.pageX-t.x,s=e.pageY-t.y;T.set(0,Math.sqrt(i*i+s*s)),_.set(0,Math.pow(T.y/E.y,n.zoomSpeed)),j(_.y),E.copy(T),U((e.pageX+t.x)*.5,(e.pageY+t.y)*.5)}function Q(e){!1!==n.enabled&&(0===I.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",q),n.domElement.addEventListener("pointerup",W)),I.push(e.pointerId),"touch"===e.pointerType?en(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i.RsA.DOLLY:if(!1===n.enableZoom)return;U(e.clientX,e.clientX),E.set(e.clientX,e.clientY),u=c.DOLLY;break;case i.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;z(e),u=c.PAN}else{if(!1===n.enableRotate)return;K(e),u=c.ROTATE}break;case i.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;K(e),u=c.ROTATE}else{if(!1===n.enablePan)return;z(e),u=c.PAN}break;default:u=c.NONE}u!==c.NONE&&n.dispatchEvent(r)}(e))}function q(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(es(e),u){case c.TOUCH_ROTATE:if(!1===n.enableRotate)return;G(e),n.update();break;case c.TOUCH_PAN:if(!1===n.enablePan)return;V(e),n.update();break;case c.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&Z(e),n.enablePan&&V(e),n.update();break;case c.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&Z(e),n.enableRotate&&G(e),n.update();break;default:u=c.NONE}}(e):function(e){switch(u){case c.ROTATE:if(!1===n.enableRotate)return;!function(e){v.set(e.clientX,e.clientY),x.subVectors(v,y).multiplyScalar(n.rotateSpeed);let t=n.domElement;B(2*Math.PI*x.x/t.clientHeight),F(2*Math.PI*x.y/t.clientHeight),y.copy(v),n.update()}(e);break;case c.DOLLY:if(!1===n.enableZoom)return;T.set(e.clientX,e.clientY),_.subVectors(T,E),_.y>0?j(C(_.y)):_.y<0&&N(C(_.y)),E.copy(T),n.update();break;case c.PAN:if(!1===n.enablePan)return;A.set(e.clientX,e.clientY),b.subVectors(A,w).multiplyScalar(n.panSpeed),D(b.x,b.y),w.copy(A),n.update()}}(e))}function W(e){switch(function(e){delete R[e.pointerId];for(let t=0;t<I.length;t++)if(I[t]==e.pointerId){I.splice(t,1);return}}(e),I.length){case 0:n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",q),n.domElement.removeEventListener("pointerup",W),n.dispatchEvent(o),u=c.NONE;break;case 1:let t=I[0],i=R[t];en({pointerId:t,pageX:i.x,pageY:i.y})}}function J(e){if(!1!==n.enabled&&!1!==n.enableZoom&&u===c.NONE){var t;e.preventDefault(),n.dispatchEvent(r),U((t=function(e){let t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100}return e.ctrlKey&&!L&&(n.deltaY*=10),n}(e)).clientX,t.clientY),t.deltaY<0?N(C(t.deltaY)):t.deltaY>0&&j(C(t.deltaY)),n.update(),n.dispatchEvent(o)}}function ee(e){"Control"===e.key&&(L=!1,n.domElement.getRootNode().removeEventListener("keyup",ee,{passive:!0,capture:!0}))}function et(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?F(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):D(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?F(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):D(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?B(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):D(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?B(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):D(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function en(e){switch(es(e),I.length){case 1:switch(n.touches.ONE){case i.QmN.ROTATE:if(!1===n.enableRotate)return;X(e),u=c.TOUCH_ROTATE;break;case i.QmN.PAN:if(!1===n.enablePan)return;$(e),u=c.TOUCH_PAN;break;default:u=c.NONE}break;case 2:switch(n.touches.TWO){case i.QmN.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&Y(e),n.enablePan&&$(e),u=c.TOUCH_DOLLY_PAN;break;case i.QmN.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&Y(e),n.enableRotate&&X(e),u=c.TOUCH_DOLLY_ROTATE;break;default:u=c.NONE}break;default:u=c.NONE}u!==c.NONE&&n.dispatchEvent(r)}function ei(e){!1!==n.enabled&&e.preventDefault()}function es(e){let t=R[e.pointerId];void 0===t&&(t=new i.FM8,R[e.pointerId]=t),t.set(e.pageX,e.pageY)}function er(e){return R[e.pointerId===I[0]?I[1]:I[0]]}n.domElement.addEventListener("contextmenu",ei),n.domElement.addEventListener("pointerdown",Q),n.domElement.addEventListener("pointercancel",W),n.domElement.addEventListener("wheel",J,{passive:!1}),n.domElement.getRootNode().addEventListener("keydown",function(e){"Control"===e.key&&(L=!0,n.domElement.getRootNode().addEventListener("keyup",ee,{passive:!0,capture:!0}))},{passive:!0,capture:!0}),this.update()}}},4782:function(e,t,n){n.d(t,{JW:function(){return F},Ys:function(){return p}});var i=n(6376);let s=new i.iMs,r=new i.Pa4,o=new i.Pa4,a=new i._fP,l={X:new i.Pa4(1,0,0),Y:new i.Pa4(0,1,0),Z:new i.Pa4(0,0,1)},h={type:"change"},c={type:"mouseDown"},u={type:"mouseUp",mode:null},d={type:"objectChange"};class p extends i.Tme{updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;s.setFromCamera(e,this.camera);let t=x(this._gizmo.picker[this.mode],s);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){s.setFromCamera(e,this.camera);let t=x(this._plane,s,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,c.mode=this.mode,this.dispatchEvent(c)}}pointerMove(e){let t=this.axis,n=this.mode,i=this.object,c=this.space;if("scale"===n?c="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(c="world"),void 0===i||null===t||!1===this.dragging||-1!==e.button)return;s.setFromCamera(e,this.camera);let u=x(this._plane,s,!0);if(u){if(this.pointEnd.copy(u.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===c&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===c&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===c&&(i.position.applyQuaternion(a.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),"world"===c&&(i.parent&&i.position.add(r.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(r.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(e*=-1),o.set(e,e,e)}else r.copy(this.pointStart),o.copy(this.pointEnd),r.applyQuaternion(this._worldQuaternionInv),o.applyQuaternion(this._worldQuaternionInv),o.divide(r),-1===t.search("X")&&(o.x=1),-1===t.search("Y")&&(o.y=1),-1===t.search("Z")&&(o.z=1);i.scale.copy(this._scaleStart).multiply(o),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);let e=20/this.worldPosition.distanceTo(r.setFromMatrixPosition(this.camera.matrixWorld)),n=!1;"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(r.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(l[t]),r.copy(l[t]),"local"===c&&r.applyQuaternion(this.worldQuaternion),r.cross(this.eye),0===r.length()?n=!0:this.rotationAngle=this._offset.dot(r.normalize())*e),("E"===t||n)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this._endNorm.cross(this._startNorm).dot(this.eye)?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===c&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(a.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(a.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(h),this.dispatchEvent(d)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(u.mode=this.mode,this.dispatchEvent(u)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(h),this.dispatchEvent(d),this.pointStart.copy(this.pointEnd))}getRaycaster(){return s}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";let n=new F;this._gizmo=n,this.add(n);let s=new O;this._plane=s,this.add(s);let r=this;function o(e,t){let i=t;Object.defineProperty(r,e,{get:function(){return void 0!==i?i:t},set:function(t){i!==t&&(i=t,s[e]=t,n[e]=t,r.dispatchEvent({type:e+"-changed",value:t}),r.dispatchEvent(h))}}),r[e]=t,s[e]=t,n[e]=t}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);let a=new i.Pa4,l=new i.Pa4,c=new i._fP,u=new i._fP,d=new i.Pa4,p=new i._fP,x=new i.Pa4,w=new i.Pa4,A=new i.Pa4,b=new i.Pa4;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",u),o("cameraPosition",d),o("cameraQuaternion",p),o("pointStart",x),o("pointEnd",w),o("rotationAxis",A),o("rotationAngle",0),o("eye",b),this._offset=new i.Pa4,this._startNorm=new i.Pa4,this._endNorm=new i.Pa4,this._cameraScale=new i.Pa4,this._parentPosition=new i.Pa4,this._parentQuaternion=new i._fP,this._parentQuaternionInv=new i._fP,this._parentScale=new i.Pa4,this._worldScaleStart=new i.Pa4,this._worldQuaternionInv=new i._fP,this._worldScale=new i.Pa4,this._positionStart=new i.Pa4,this._quaternionStart=new i._fP,this._scaleStart=new i.Pa4,this._getPointer=m.bind(this),this._onPointerDown=g.bind(this),this._onPointerHover=f.bind(this),this._onPointerMove=y.bind(this),this._onPointerUp=v.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}}function m(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{let t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function f(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function g(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function y(e){this.enabled&&this.pointerMove(this._getPointer(e))}function v(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function x(e,t,n){let i=t.intersectObject(e,!0);for(let e=0;e<i.length;e++)if(i[e].object.visible||n)return i[e];return!1}let w=new i.USm,A=new i.Pa4(0,1,0),b=new i.Pa4(0,0,0),E=new i.yGw,T=new i._fP,_=new i._fP,P=new i.Pa4,M=new i.yGw,S=new i.Pa4(1,0,0),I=new i.Pa4(0,1,0),R=new i.Pa4(0,0,1),L=new i.Pa4,C=new i.Pa4,B=new i.Pa4;class F extends i.Tme{updateMatrixWorld(e){let t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:_;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=(n=(n=n.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let e=0;e<n.length;e++){let i;let s=n[e];if(s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),i=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(i*this.size/4),"helper"===s.tag){s.visible=!1,"AXIS"===s.name?(s.visible=!!this.axis,"X"===this.axis&&(a.setFromEuler(w.set(0,0,0)),s.quaternion.copy(t).multiply(a),Math.abs(A.copy(S).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(a.setFromEuler(w.set(0,0,Math.PI/2)),s.quaternion.copy(t).multiply(a),Math.abs(A.copy(I).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(a.setFromEuler(w.set(0,Math.PI/2,0)),s.quaternion.copy(t).multiply(a),Math.abs(A.copy(R).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(a.setFromEuler(w.set(0,Math.PI/2,0)),A.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(E.lookAt(b,A,I)),s.quaternion.multiply(a),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),r.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),r.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(r),s.visible=this.dragging):(s.quaternion.copy(t),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name)));continue}s.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===s.name&&Math.abs(A.copy(S).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"===s.name&&Math.abs(A.copy(I).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"===s.name&&Math.abs(A.copy(R).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&.2>Math.abs(A.copy(R).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&.2>Math.abs(A.copy(S).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&.2>Math.abs(A.copy(I).applyQuaternion(t).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):"rotate"===this.mode&&(T.copy(t),A.copy(this.eye).applyQuaternion(a.copy(t).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(E.lookAt(this.eye,b,I)),"X"===s.name&&(a.setFromAxisAngle(S,Math.atan2(-A.y,A.z)),a.multiplyQuaternions(T,a),s.quaternion.copy(a)),"Y"===s.name&&(a.setFromAxisAngle(I,Math.atan2(A.x,A.z)),a.multiplyQuaternions(T,a),s.quaternion.copy(a)),"Z"===s.name&&(a.setFromAxisAngle(R,Math.atan2(A.y,A.x)),a.multiplyQuaternions(T,a),s.quaternion.copy(a))),s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis?(s.material.color.setHex(16776960),s.material.opacity=1):this.axis.split("").some(function(e){return s.name===e})&&(s.material.color.setHex(16776960),s.material.opacity=1))}super.updateMatrixWorld(e)}constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";let e=new i.vBJ({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new i.nls({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;let s=t.clone();s.opacity=.5;let r=e.clone();r.color.setHex(16711680);let o=e.clone();o.color.setHex(65280);let a=e.clone();a.color.setHex(255);let l=e.clone();l.color.setHex(16711680),l.opacity=.5;let h=e.clone();h.color.setHex(65280),h.opacity=.5;let c=e.clone();c.color.setHex(255),c.opacity=.5;let u=e.clone();u.opacity=.25;let d=e.clone();d.color.setHex(16776960),d.opacity=.25,e.clone().color.setHex(16776960);let p=e.clone();p.color.setHex(7895160);let m=new i.fHI(0,.04,.1,12);m.translate(0,.05,0);let f=new i.DvJ(.08,.08,.08);f.translate(0,.04,0);let g=new i.u9r;g.setAttribute("position",new i.a$l([0,0,0,1,0,0],3));let y=new i.fHI(.0075,.0075,.5,3);function v(e,t){let n=new i.XvJ(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}y.translate(0,.25,0);let x={X:[[new i.Kj0(m,r),[.5,0,0],[0,0,-Math.PI/2]],[new i.Kj0(m,r),[-.5,0,0],[0,0,Math.PI/2]],[new i.Kj0(y,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new i.Kj0(m,o),[0,.5,0]],[new i.Kj0(m,o),[0,-.5,0],[Math.PI,0,0]],[new i.Kj0(y,o)]],Z:[[new i.Kj0(m,a),[0,0,.5],[Math.PI/2,0,0]],[new i.Kj0(m,a),[0,0,-.5],[-Math.PI/2,0,0]],[new i.Kj0(y,a),null,[Math.PI/2,0,0]]],XYZ:[[new i.Kj0(new i.pQR(.1,0),u.clone()),[0,0,0]]],XY:[[new i.Kj0(new i.DvJ(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new i.Kj0(new i.DvJ(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i.Kj0(new i.DvJ(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},w={X:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,.3,0]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new i.Kj0(new i.pQR(.2,0),n)]],XY:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},A={START:[[new i.Kj0(new i.pQR(.01,2),s),null,null,null,"helper"]],END:[[new i.Kj0(new i.pQR(.01,2),s),null,null,null,"helper"]],DELTA:[[new i.x12(function(){let e=new i.u9r;return e.setAttribute("position",new i.a$l([0,0,0,1,1,1],3)),e}(),s),null,null,null,"helper"]],X:[[new i.x12(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new i.x12(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new i.x12(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},b={XYZE:[[new i.Kj0(v(.5,1),p),null,[0,Math.PI/2,0]]],X:[[new i.Kj0(v(.5,.5),r)]],Y:[[new i.Kj0(v(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new i.Kj0(v(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new i.Kj0(v(.75,1),d),null,[0,Math.PI/2,0]]]},E={AXIS:[[new i.x12(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},T={XYZE:[[new i.Kj0(new i.xo$(.25,10,8),n)]],X:[[new i.Kj0(new i.XvJ(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new i.Kj0(new i.XvJ(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new i.Kj0(new i.XvJ(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new i.Kj0(new i.XvJ(.75,.1,2,24),n)]]},_={X:[[new i.Kj0(f,r),[.5,0,0],[0,0,-Math.PI/2]],[new i.Kj0(y,r),[0,0,0],[0,0,-Math.PI/2]],[new i.Kj0(f,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new i.Kj0(f,o),[0,.5,0]],[new i.Kj0(y,o)],[new i.Kj0(f,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new i.Kj0(f,a),[0,0,.5],[Math.PI/2,0,0]],[new i.Kj0(y,a),[0,0,0],[Math.PI/2,0,0]],[new i.Kj0(f,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new i.Kj0(new i.DvJ(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new i.Kj0(new i.DvJ(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i.Kj0(new i.DvJ(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new i.Kj0(new i.DvJ(.1,.1,.1),u.clone())]]},P={X:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,.3,0]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new i.Kj0(new i.fHI(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new i.Kj0(new i.DvJ(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new i.Kj0(new i.DvJ(.2,.2,.2),n),[0,0,0]]]},M={X:[[new i.x12(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new i.x12(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new i.x12(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function S(e){let t=new i.Tme;for(let n in e)for(let i=e[n].length;i--;){let s=e[n][i][0].clone(),r=e[n][i][1],o=e[n][i][2],a=e[n][i][3],l=e[n][i][4];s.name=n,s.tag=l,r&&s.position.set(r[0],r[1],r[2]),o&&s.rotation.set(o[0],o[1],o[2]),a&&s.scale.set(a[0],a[1],a[2]),s.updateMatrix();let h=s.geometry.clone();h.applyMatrix4(s.matrix),s.geometry=h,s.renderOrder=1/0,s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),t.add(s)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=S(x)),this.add(this.gizmo.rotate=S(b)),this.add(this.gizmo.scale=S(_)),this.add(this.picker.translate=S(w)),this.add(this.picker.rotate=S(T)),this.add(this.picker.scale=S(P)),this.add(this.helper.translate=S(A)),this.add(this.helper.rotate=S(E)),this.add(this.helper.scale=S(M)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class O extends i.Kj0{updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),L.copy(S).applyQuaternion("local"===t?this.worldQuaternion:_),C.copy(I).applyQuaternion("local"===t?this.worldQuaternion:_),B.copy(R).applyQuaternion("local"===t?this.worldQuaternion:_),A.copy(C),this.mode){case"translate":case"scale":switch(this.axis){case"X":A.copy(this.eye).cross(L),P.copy(L).cross(A);break;case"Y":A.copy(this.eye).cross(C),P.copy(C).cross(A);break;case"Z":A.copy(this.eye).cross(B),P.copy(B).cross(A);break;case"XY":P.copy(B);break;case"YZ":P.copy(L);break;case"XZ":A.copy(B),P.copy(C);break;case"XYZ":case"E":P.set(0,0,0)}break;default:P.set(0,0,0)}0===P.length()?this.quaternion.copy(this.cameraQuaternion):(M.lookAt(r.set(0,0,0),P,A),this.quaternion.setFromRotationMatrix(M)),super.updateMatrixWorld(e)}constructor(){super(new i._12(1e5,1e5,2,2),new i.vBJ({visible:!1,wireframe:!0,side:i.ehD,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}}},647:function(e,t,n){n.d(t,{M:function(){return b}});var i=n(6376);let s=new i.iWj,r=new i.Pa4,o=new i.Pa4,a=new i.Pa4,l=new i.Pa4,h=new i.Pa4,c=new i.Pa4,u=new i.Pa4,d=new i.Pa4,p=new i.Pa4,m=new i.Pa4,f=new i.Pa4,g=new i.Pa4,y=new i.Pa4,v=new i.Pa4,x=new i.yGw,w=new i._fP,A=new i.Pa4;class b{select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(s,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){o.copy(e),o.x=Math.min(e.x,t.x),o.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),a.setFromMatrixPosition(this.camera.matrixWorld),l.copy(o),h.set(t.x,o.y,0),c.copy(t),u.set(o.x,t.y,0),l.unproject(this.camera),h.unproject(this.camera),c.unproject(this.camera),u.unproject(this.camera),g.copy(l).sub(a),y.copy(h).sub(a),v.copy(c).sub(a),g.normalize(),y.normalize(),v.normalize(),g.multiplyScalar(this.deep),y.multiplyScalar(this.deep),v.multiplyScalar(this.deep),g.add(a),y.add(a),v.add(a);let n=s.planes;n[0].setFromCoplanarPoints(a,l,h),n[1].setFromCoplanarPoints(a,h,c),n[2].setFromCoplanarPoints(c,u,a),n[3].setFromCoplanarPoints(u,l,a),n[4].setFromCoplanarPoints(h,c,u),n[5].setFromCoplanarPoints(v,y,g),n[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){let n=Math.min(e.x,t.x),i=Math.max(e.y,t.y),r=Math.max(e.x,t.x),o=Math.min(e.y,t.y);l.set(n,i,-1),h.set(r,i,-1),c.set(r,o,-1),u.set(n,o,-1),d.set(n,i,1),p.set(r,i,1),m.set(r,o,1),f.set(n,o,1),l.unproject(this.camera),h.unproject(this.camera),c.unproject(this.camera),u.unproject(this.camera),d.unproject(this.camera),p.unproject(this.camera),m.unproject(this.camera),f.unproject(this.camera);let a=s.planes;a[0].setFromCoplanarPoints(l,d,p),a[1].setFromCoplanarPoints(h,p,m),a[2].setFromCoplanarPoints(m,f,u),a[3].setFromCoplanarPoints(f,d,l),a[4].setFromCoplanarPoints(h,c,u),a[5].setFromCoplanarPoints(m,p,d),a[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if(t.isMesh||t.isLine||t.isPoints){if(t.isInstancedMesh){this.instances[t.uuid]=[];for(let n=0;n<t.count;n++)t.getMatrixAt(n,x),x.decompose(r,w,A),r.applyMatrix4(t.matrixWorld),e.containsPoint(r)&&this.instances[t.uuid].push(n)}else null===t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),r.copy(t.geometry.boundingSphere.center),r.applyMatrix4(t.matrixWorld),e.containsPoint(r)&&this.collection.push(t)}if(t.children.length>0)for(let n=0;n<t.children.length;n++)this.searchChildInFrustum(e,t.children[n])}constructor(e,t,n=Number.MAX_VALUE){this.camera=e,this.scene=t,this.startPoint=new i.Pa4,this.endPoint=new i.Pa4,this.collection=[],this.instances={},this.deep=n}}},9462:function(e,t,n){n.d(t,{Q:function(){return s}});var i=n(6376);class s{dispose(){this.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown),this.renderer.domElement.removeEventListener("pointermove",this.onPointerMove),this.renderer.domElement.removeEventListener("pointerup",this.onPointerUp)}onSelectStart(e){this.element.style.display="none",this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY}onSelectMove(e){this.element.style.display="block",this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"}onSelectOver(){this.element.parentElement.removeChild(this.element)}constructor(e,t){this.element=document.createElement("div"),this.element.classList.add(t),this.element.style.pointerEvents="none",this.renderer=e,this.startPoint=new i.FM8,this.pointTopLeft=new i.FM8,this.pointBottomRight=new i.FM8,this.isDown=!1,this.enabled=!0,this.onPointerDown=(function(e){!1!==this.enabled&&(this.isDown=!0,this.onSelectStart(e))}).bind(this),this.onPointerMove=(function(e){!1!==this.enabled&&this.isDown&&this.onSelectMove(e)}).bind(this),this.onPointerUp=(function(){!1!==this.enabled&&(this.isDown=!1,this.onSelectOver())}).bind(this),this.renderer.domElement.addEventListener("pointerdown",this.onPointerDown),this.renderer.domElement.addEventListener("pointermove",this.onPointerMove),this.renderer.domElement.addEventListener("pointerup",this.onPointerUp)}}},2111:function(e,t,n){n.d(t,{E:function(){return r}});var i=n(6376);function s(e,t){if(t===i.WwZ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==i.z$h&&t!==i.UlW)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let n=e.getIndex();if(null===n){let t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}let s=n.count-2,r=[];if(t===i.z$h)for(let e=1;e<=s;e++)r.push(n.getX(0)),r.push(n.getX(e)),r.push(n.getX(e+1));else for(let e=0;e<s;e++)e%2==0?(r.push(n.getX(e)),r.push(n.getX(e+1)),r.push(n.getX(e+2))):(r.push(n.getX(e+2)),r.push(n.getX(e+1)),r.push(n.getX(e)));r.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=e.clone();return o.setIndex(r),o.clearGroups(),o}}class r extends i.aNw{load(e,t,n,s){let r;let o=this;if(""!==this.resourcePath)r=this.resourcePath;else if(""!==this.path){let t=i.Zp0.extractUrlBase(e);r=i.Zp0.resolveURL(t,this.path)}else r=i.Zp0.extractUrlBase(e);this.manager.itemStart(e);let a=function(t){s?s(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},l=new i.hH6(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(n){try{o.parse(n,r,function(n){t(n),o.manager.itemEnd(e)},a)}catch(e){a(e)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let s;let r={},o={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer){if(l.decode(new Uint8Array(e,0,4))===_){try{r[a.KHR_BINARY_GLTF]=new M(e)}catch(e){i&&i(e);return}s=JSON.parse(r[a.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e))}else s=e;if(void 0===s.asset||s.asset.version[0]<2){i&&i(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let c=new V(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](c);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[t.name]=t,r[t.name]=!0}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let t=s.extensionsUsed[e],n=s.extensionsRequired||[];switch(t){case a.KHR_MATERIALS_UNLIT:r[t]=new h;break;case a.KHR_DRACO_MESH_COMPRESSION:r[t]=new S(s,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:r[t]=new I;break;case a.KHR_MESH_QUANTIZATION:r[t]=new R;break;default:n.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}c.setExtensions(r),c.setPlugins(o),c.parse(n,i)}parseAsync(e,t){let n=this;return new Promise(function(i,s){n.parse(e,t,i,s)})}constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new u(e)}),this.register(function(e){return new w(e)}),this.register(function(e){return new A(e)}),this.register(function(e){return new b(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new m(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new g(e)}),this.register(function(e){return new c(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new d(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new T(e)})}}function o(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class l{_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){let i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){let t;let n=this.parser,s="light:"+e,r=n.cache.get(s);if(r)return r;let o=n.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],l=new i.Ilk(16777215);void 0!==a.color&&l.setRGB(a.color[0],a.color[1],a.color[2],i.GUF);let h=void 0!==a.range?a.range:0;switch(a.type){case"directional":(t=new i.Ox3(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new i.cek(l)).distance=h;break;case"spot":(t=new i.PMe(l)).distance=h,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,t.angle=a.spot.outerConeAngle,t.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return t.position.set(0,0,0),t.decay=2,X(t,a),void 0!==a.intensity&&(t.intensity=a.intensity),t.name=n.createUniqueName(a.name||"light_"+e),r=Promise.resolve(t),n.cache.add(s,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,n=this.parser,i=n.json.nodes[e],s=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return n._getNodeRef(t.cache,s,e)})}constructor(e){this.parser=e,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}}class h{getMaterialType(){return i.vBJ}extendParams(e,t,n){let s=[];e.color=new i.Ilk(1,1,1),e.opacity=1;let r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){let t=r.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],i.GUF),e.opacity=t[3]}void 0!==r.baseColorTexture&&s.push(n.assignTexture(e,"map",r.baseColorTexture,i.KI_))}return Promise.all(s)}constructor(){this.name=a.KHR_MATERIALS_UNLIT}}class c{extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=n.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_EMISSIVE_STRENGTH}}class u{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let r=[],o=s.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){let e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new i.FM8(e,e)}return Promise.all(r)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_CLEARCOAT}}class d{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],r=i.extensions[this.name];return void 0!==r.iridescenceFactor&&(t.iridescence=r.iridescenceFactor),void 0!==r.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),void 0!==r.iridescenceIor&&(t.iridescenceIOR=r.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==r.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),void 0!==r.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),void 0!==r.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(s)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IRIDESCENCE}}class p{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let r=[];t.sheenColor=new i.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=s.extensions[this.name];if(void 0!==o.sheenColorFactor){let e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],i.GUF)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&r.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,i.KI_)),void 0!==o.sheenRoughnessTexture&&r.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SHEEN}}class m{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],r=i.extensions[this.name];return void 0!==r.transmissionFactor&&(t.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(s)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_TRANSMISSION}}class f{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let r=[],o=s.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&r.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new i.Ilk().setRGB(a[0],a[1],a[2],i.GUF),Promise.all(r)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_VOLUME}}class g{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=n.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IOR}}class y{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let r=[],o=s.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&r.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new i.Ilk().setRGB(a[0],a[1],a[2],i.GUF),void 0!==o.specularColorTexture&&r.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,i.KI_)),Promise.all(r)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SPECULAR}}class v{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],r=i.extensions[this.name];return t.bumpScale=void 0!==r.bumpFactor?r.bumpFactor:1,void 0!==r.bumpTexture&&s.push(n.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(s)}constructor(e){this.parser=e,this.name=a.EXT_MATERIALS_BUMP}}class x{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i.EJi:null}extendMaterialParams(e,t){let n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();let s=[],r=i.extensions[this.name];return void 0!==r.anisotropyStrength&&(t.anisotropy=r.anisotropyStrength),void 0!==r.anisotropyRotation&&(t.anisotropyRotation=r.anisotropyRotation),void 0!==r.anisotropyTexture&&s.push(n.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(s)}constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_ANISOTROPY}}class w{loadTexture(e){let t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;let s=i.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(!(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,s.source,r)}constructor(e){this.parser=e,this.name=a.KHR_TEXTURE_BASISU}}class A{loadTexture(e){let t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;let r=s.extensions[t],o=i.images[r.source],a=n.textureLoader;if(o.uri){let e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return n.loadTextureImage(e,r.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_WEBP,this.isSupported=null}}class b{loadTexture(e){let t=this.name,n=this.parser,i=n.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;let r=s.extensions[t],o=i.images[r.source],a=n.textureLoader;if(o.uri){let e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return n.loadTextureImage(e,r.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_AVIF,this.isSupported=null}}class E{loadBufferView(e){let t=this.parser.json,n=t.bufferViews[e];if(!n.extensions||!n.extensions[this.name])return null;{let e=n.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return i.then(function(t){let n=e.byteOffset||0,i=e.byteLength||0,r=e.count,o=e.byteStride,a=new Uint8Array(t,n,i);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(r,o,a,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){let t=new ArrayBuffer(r*o);return s.decodeGltfBuffer(new Uint8Array(t),r,o,a,e.mode,e.filter),t})})}}constructor(e){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=e}}class T{createNodeMesh(e){let t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;for(let e of t.meshes[n.mesh].primitives)if(e.mode!==F.TRIANGLES&&e.mode!==F.TRIANGLE_STRIP&&e.mode!==F.TRIANGLE_FAN&&void 0!==e.mode)return null;let s=n.extensions[this.name].attributes,r=[],o={};for(let e in s)r.push(this.parser.getDependency("accessor",s[e]).then(t=>(o[e]=t,o[e])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(e=>{let t=e.pop(),n=t.isGroup?t.children:[t],s=e[0].count,r=[];for(let e of n){let t=new i.yGw,n=new i.Pa4,a=new i._fP,l=new i.Pa4(1,1,1),h=new i.SPe(e.geometry,e.material,s);for(let e=0;e<s;e++)o.TRANSLATION&&n.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&l.fromBufferAttribute(o.SCALE,e),h.setMatrixAt(e,t.compose(n,a,l));for(let t in o)if("_COLOR_0"===t){let e=o[t];h.instanceColor=new i.lb7(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);i.Tme.prototype.copy.call(h,e),this.parser.assignFinalMaterial(h),r.push(h)}return t.isGroup?(t.clear(),t.add(...r),t):r[0]}))}constructor(e){this.name=a.EXT_MESH_GPU_INSTANCING,this.parser=e}}let _="glTF",P={JSON:1313821514,BIN:5130562};class M{constructor(e){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==_)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let i=this.header.length-12,s=new DataView(e,12),r=0;for(;r<i;){let t=s.getUint32(r,!0);r+=4;let i=s.getUint32(r,!0);if(r+=4,i===P.JSON){let i=new Uint8Array(e,12+r,t);this.content=n.decode(i)}else if(i===P.BIN){let n=12+r;this.body=e.slice(n,n+t)}r+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class S{decodePrimitive(e,t){let n=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},h={};for(let e in o)a[N[e]||e.toLowerCase()]=o[e];for(let t in e.attributes){let i=N[t]||t.toLowerCase();if(void 0!==o[t]){let s=n.accessors[e.attributes[t]],r=O[s.componentType];h[i]=r.name,l[i]=!0===s.normalized}}return t.getDependency("bufferView",r).then(function(e){return new Promise(function(t,n){s.decodeDracoFile(e,function(e){for(let t in e.attributes){let n=e.attributes[t],i=l[t];void 0!==i&&(n.normalized=i)}t(e)},a,h,i.GUF,n)})})}constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}}class I{extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}constructor(){this.name=a.KHR_TEXTURE_TRANSFORM}}class R{constructor(){this.name=a.KHR_MESH_QUANTIZATION}}class L extends i._C8{copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let e=0;e!==i;e++)t[e]=n[s+e];return t}interpolate_(e,t,n,i){let s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,h=i-t,c=(n-t)/h,u=c*c,d=u*c,p=e*l,m=p-l,f=-2*d+3*u,g=d-u,y=1-f,v=g-u+c;for(let e=0;e!==o;e++){let t=r[m+e+o],n=r[m+e+a]*h,i=r[p+e+o],l=r[p+e]*h;s[e]=y*t+v*n+f*i+g*l}return s}constructor(e,t,n,i){super(e,t,n,i)}}let C=new i._fP;class B extends L{interpolate_(e,t,n,i){let s=super.interpolate_(e,t,n,i);return C.fromArray(s).normalize().toArray(s),s}}let F={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},k={9728:i.TyD,9729:i.wem,9984:i.YLQ,9985:i.qyh,9986:i.aH4,9987:i.D1R},D={33071:i.uWy,33648:i.OoA,10497:i.rpg},j={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},U={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:i.NMF,STEP:i.Syv},K={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function z(e,t,n){for(let i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function X(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function $(e){let t="",n=Object.keys(e).sort();for(let i=0,s=n.length;i<s;i++)t+=n[i]+":"+e[n[i]]+";";return t}function Y(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let G=new i.yGw;class V{setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(t){let r={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};return z(s,r,i),X(r,i),Promise.all(n._invokeAll(function(e){return e.afterRoot&&e.afterRoot(r)})).then(function(){e(r)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,i=t.length;n<i;n++){let i=t[n].joints;for(let t=0,n=i.length;t<n;t++)e[i[t]].isBone=!0}for(let t=0,i=e.length;t<i;t++){let i=e[t];void 0!==i.mesh&&(this._addNodeRef(this.meshCache,i.mesh),void 0!==i.skin&&(n[i.mesh].isSkinnedMesh=!0)),void 0!==i.camera&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;let i=n.clone(),s=(e,t)=>{let n=this.associations.get(e);for(let[i,r]of(null!=n&&this.associations.set(t,n),e.children.entries()))s(r,t.children[i])};return s(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let i=e(t[n]);if(i)return i}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let i=0;i<t.length;i++){let s=e(t[i]);s&&n.push(s)}return n}getDependency(e,t){let n=e+":"+t,i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":i=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(!(i=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,i){return n.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);let s=this.options;return new Promise(function(e,r){n.load(i.Zp0.resolveURL(t.uri,s.path),e,void 0,function(){r(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)})}loadAccessor(e){let t=this,n=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){let e=j[s.type],t=O[s.componentType],n=!0===s.normalized,r=new t(s.count*e);return Promise.resolve(new i.TlE(r,e,n))}let r=[];return void 0!==s.bufferView?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),void 0!==s.sparse&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(e){let r,o;let a=e[0],l=j[s.type],h=O[s.componentType],c=h.BYTES_PER_ELEMENT,u=c*l,d=s.byteOffset||0,p=void 0!==s.bufferView?n.bufferViews[s.bufferView].byteStride:void 0,m=!0===s.normalized;if(p&&p!==u){let e=Math.floor(d/p),n="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count,u=t.cache.get(n);u||(r=new h(a,e*p,s.count*p/c),u=new i.vpT(r,p/c),t.cache.add(n,u)),o=new i.kB5(u,l,d%p/c,m)}else r=null===a?new h(s.count*l):new h(a,d,s.count*l),o=new i.TlE(r,l,m);if(void 0!==s.sparse){let t=j.SCALAR,n=O[s.sparse.indices.componentType],r=s.sparse.indices.byteOffset||0,c=s.sparse.values.byteOffset||0,u=new n(e[1],r,s.sparse.count*t),d=new h(e[2],c,s.sparse.count*l);null!==a&&(o=new i.TlE(o.array.slice(),o.itemSize,o.normalized));for(let e=0,t=u.length;e<t;e++){let t=u[e];if(o.setX(t,d[e*l]),l>=2&&o.setY(t,d[e*l+1]),l>=3&&o.setZ(t,d[e*l+2]),l>=4&&o.setW(t,d[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})}loadTexture(e){let t=this.json,n=this.options,i=t.textures[e].source,s=t.images[i],r=this.textureLoader;if(s.uri){let e=n.manager.getHandler(s.uri);null!==e&&(r=e)}return this.loadTextureImage(e,i,r)}loadTextureImage(e,t,n){let s=this,r=this.json,o=r.textures[e],a=r.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let h=this.loadImageSource(t,n).then(function(t){t.flipY=!1,t.name=o.name||a.name||"",""===t.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(t.name=a.uri);let n=(r.samplers||{})[o.sampler]||{};return t.magFilter=k[n.magFilter]||i.wem,t.minFilter=k[n.minFilter]||i.D1R,t.wrapS=D[n.wrapS]||i.rpg,t.wrapT=D[n.wrapT]||i.rpg,s.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,t){let n=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let r=n.images[e],o=self.URL||self.webkitURL,a=r.uri||"",l=!1;if(void 0!==r.bufferView)a=this.getDependency("bufferView",r.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:r.mimeType});return a=o.createObjectURL(t)});else if(void 0===r.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(a).then(function(e){return new Promise(function(n,r){let o=n;!0===t.isImageBitmapLoader&&(o=function(e){let t=new i.xEZ(e);t.needsUpdate=!0,n(t)}),t.load(i.Zp0.resolveURL(e,s.path),o,void 0,r)})}).then(function(e){var t;return!0===l&&o.revokeObjectURL(a),e.userData.mimeType=r.mimeType||((t=r.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e});return this.sourceCache[e]=h,h}assignTexture(e,t,n,i){let s=this;return this.getDependency("texture",n.index).then(function(r){if(!r)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((r=r.clone()).channel=n.texCoord),s.extensions[a.KHR_TEXTURE_TRANSFORM]){let e=void 0!==n.extensions?n.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=s.associations.get(r);r=s.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(r,e),s.associations.set(r,t)}}return void 0!==i&&(r.colorSpace=i),e[t]=r,r})}assignFinalMaterial(e){let t=e.geometry,n=e.material,s=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+n.uuid,t=this.cache.get(e);t||(t=new i.UY4,i.F5T.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){let e="LineBasicMaterial:"+n.uuid,t=this.cache.get(e);t||(t=new i.nls,i.F5T.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(s||r||o){let e="ClonedMaterial:"+n.uuid+":";s&&(e+="derivative-tangents:"),r&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),r&&(t.vertexColors=!0),o&&(t.flatShading=!0),s&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return i.Wid}loadMaterial(e){let t;let n=this,s=this.json,r=this.extensions,o=s.materials[e],l={},h=o.extensions||{},c=[];if(h[a.KHR_MATERIALS_UNLIT]){let e=r[a.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),c.push(e.extendParams(l,o,n))}else{let s=o.pbrMetallicRoughness||{};if(l.color=new i.Ilk(1,1,1),l.opacity=1,Array.isArray(s.baseColorFactor)){let e=s.baseColorFactor;l.color.setRGB(e[0],e[1],e[2],i.GUF),l.opacity=e[3]}void 0!==s.baseColorTexture&&c.push(n.assignTexture(l,"map",s.baseColorTexture,i.KI_)),l.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,l.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(c.push(n.assignTexture(l,"metalnessMap",s.metallicRoughnessTexture)),c.push(n.assignTexture(l,"roughnessMap",s.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)})))}!0===o.doubleSided&&(l.side=i.ehD);let u=o.alphaMode||K.OPAQUE;if(u===K.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,u===K.MASK&&(l.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==i.vBJ&&(c.push(n.assignTexture(l,"normalMap",o.normalTexture)),l.normalScale=new i.FM8(1,1),void 0!==o.normalTexture.scale)){let e=o.normalTexture.scale;l.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&t!==i.vBJ&&(c.push(n.assignTexture(l,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(l.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==i.vBJ){let e=o.emissiveFactor;l.emissive=new i.Ilk().setRGB(e[0],e[1],e[2],i.GUF)}return void 0!==o.emissiveTexture&&t!==i.vBJ&&c.push(n.assignTexture(l,"emissiveMap",o.emissiveTexture,i.KI_)),Promise.all(c).then(function(){let i=new t(l);return o.name&&(i.name=o.name),X(i,o),n.associations.set(i,{materials:e}),o.extensions&&z(r,i,o),i})}createUniqueName(e){let t=i.iUV.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,n=this.extensions,s=this.primitiveCache,r=[];for(let o=0,l=e.length;o<l;o++){let l=e[o],h=function(e){let t;let n=e.extensions&&e.extensions[a.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+$(n.attributes):e.indices+":"+$(e.attributes)+":"+e.mode,void 0!==e.targets)for(let n=0,i=e.targets.length;n<i;n++)t+=":"+$(e.targets[n]);return t}(l),c=s[h];if(c)r.push(c.promise);else{let e;e=l.extensions&&l.extensions[a.KHR_DRACO_MESH_COMPRESSION]?function(e){return n[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return Z(n,e,t)})}(l):Z(new i.u9r,l,t),s[h]={primitive:l,promise:e},r.push(e)}}return Promise.all(r)}loadMesh(e){let t=this,n=this.json,r=this.extensions,o=n.meshes[e],a=o.primitives,l=[];for(let e=0,t=a.length;e<t;e++){var h;let t=void 0===a[e].material?(void 0===(h=this.cache).DefaultMaterial&&(h.DefaultMaterial=new i.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:i.Wl3})),h.DefaultMaterial):this.getDependency("material",a[e].material);l.push(t)}return l.push(t.loadGeometries(a)),Promise.all(l).then(function(n){let l=n.slice(0,n.length-1),h=n[n.length-1],c=[];for(let n=0,u=h.length;n<u;n++){let u;let d=h[n],p=a[n],m=l[n];if(p.mode===F.TRIANGLES||p.mode===F.TRIANGLE_STRIP||p.mode===F.TRIANGLE_FAN||void 0===p.mode)!0===(u=!0===o.isSkinnedMesh?new i.TUv(d,m):new i.Kj0(d,m)).isSkinnedMesh&&u.normalizeSkinWeights(),p.mode===F.TRIANGLE_STRIP?u.geometry=s(u.geometry,i.UlW):p.mode===F.TRIANGLE_FAN&&(u.geometry=s(u.geometry,i.z$h));else if(p.mode===F.LINES)u=new i.ejS(d,m);else if(p.mode===F.LINE_STRIP)u=new i.x12(d,m);else if(p.mode===F.LINE_LOOP)u=new i.blk(d,m);else if(p.mode===F.POINTS)u=new i.woe(d,m);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);Object.keys(u.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){let n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,i=n.length;t<i;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(u,o),u.name=t.createUniqueName(o.name||"mesh_"+e),X(u,o),p.extensions&&z(r,u,p),t.assignFinalMaterial(u),c.push(u)}for(let n=0,i=c.length;n<i;n++)t.associations.set(c[n],{meshes:e,primitives:n});if(1===c.length)return o.extensions&&z(r,c[0],o),c[0];let u=new i.ZAu;o.extensions&&z(r,u,o),t.associations.set(u,{meshes:e});for(let e=0,t=c.length;e<t;e++)u.add(c[e]);return u})}loadCamera(e){let t;let n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===n.type?t=new i.cPb(i.M8C.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===n.type&&(t=new i.iKG(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),X(t,n),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],n=[];for(let e=0,i=t.joints.length;e<i;e++)n.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(e){let n=e.pop(),s=[],r=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];if(a){s.push(a);let e=new i.yGw;null!==n&&e.fromArray(n.array,16*o),r.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new i.OdW(s,r)})}loadAnimation(e){let t=this.json,n=this,s=t.animations[e],r=s.name?s.name:"animation_"+e,o=[],a=[],l=[],h=[],c=[];for(let e=0,t=s.channels.length;e<t;e++){let t=s.channels[e],n=s.samplers[t.sampler],i=t.target,r=i.node,u=void 0!==s.parameters?s.parameters[n.input]:n.input,d=void 0!==s.parameters?s.parameters[n.output]:n.output;void 0!==i.node&&(o.push(this.getDependency("node",r)),a.push(this.getDependency("accessor",u)),l.push(this.getDependency("accessor",d)),h.push(n),c.push(i))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(h),Promise.all(c)]).then(function(e){let t=e[0],s=e[1],o=e[2],a=e[3],l=e[4],h=[];for(let e=0,i=t.length;e<i;e++){let i=t[e],r=s[e],c=o[e],u=a[e],d=l[e];if(void 0===i)continue;i.updateMatrix&&i.updateMatrix();let p=n._createAnimationTracks(i,r,c,u,d);if(p)for(let e=0;e<p.length;e++)h.push(p[e])}return new i.m7l(r,void 0,h)})}createNodeMesh(e){let t=this.json,n=this,i=t.nodes[e];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then(function(e){let t=n._getNodeRef(n.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,n=i.weights.length;t<n;t++)e.morphTargetInfluences[t]=i.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],n=this._loadNodeShallow(e),i=[],s=t.children||[];for(let e=0,t=s.length;e<t;e++)i.push(this.getDependency("node",s[e]));let r=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([n,Promise.all(i),r]).then(function(e){let t=e[0],n=e[1],i=e[2];null!==i&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(i,G)});for(let e=0,i=n.length;e<i;e++)t.add(n[e]);return t})}_loadNodeShallow(e){let t=this.json,n=this.extensions,s=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let r=t.nodes[e],o=r.name?s.createUniqueName(r.name):"",a=[],l=s._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&a.push(l),void 0!==r.camera&&a.push(s.getDependency("camera",r.camera).then(function(e){return s._getNodeRef(s.cameraCache,r.camera,e)})),s._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){a.push(e)}),this.nodeCache[e]=Promise.all(a).then(function(t){let a;if((a=!0===r.isBone?new i.N$j:t.length>1?new i.ZAu:1===t.length?t[0]:new i.Tme)!==t[0])for(let e=0,n=t.length;e<n;e++)a.add(t[e]);if(r.name&&(a.userData.name=r.name,a.name=o),X(a,r),r.extensions&&z(n,a,r),void 0!==r.matrix){let e=new i.yGw;e.fromArray(r.matrix),a.applyMatrix4(e)}else void 0!==r.translation&&a.position.fromArray(r.translation),void 0!==r.rotation&&a.quaternion.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale);return s.associations.has(a)||s.associations.set(a,{}),s.associations.get(a).nodes=e,a}),this.nodeCache[e]}loadScene(e){let t=this.extensions,n=this.json.scenes[e],s=this,r=new i.ZAu;n.name&&(r.name=s.createUniqueName(n.name)),X(r,n),n.extensions&&z(t,r,n);let o=n.nodes||[],a=[];for(let e=0,t=o.length;e<t;e++)a.push(s.getDependency("node",o[e]));return Promise.all(a).then(function(e){for(let t=0,n=e.length;t<n;t++)r.add(e[t]);return s.associations=(e=>{let t=new Map;for(let[e,n]of s.associations)(e instanceof i.F5T||e instanceof i.xEZ)&&t.set(e,n);return e.traverse(e=>{let n=s.associations.get(e);null!=n&&t.set(e,n)}),t})(r),r})}_createAnimationTracks(e,t,n,s,r){let o;let a=[],l=e.name?e.name:e.uuid,h=[];switch(U[r.path]===U.weights?e.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(l),U[r.path]){case U.weights:o=i.dUE;break;case U.rotation:o=i.iLg;break;case U.position:case U.scale:o=i.yC1;break;default:o=1===n.itemSize?i.dUE:i.yC1}let c=void 0!==s.interpolation?H[s.interpolation]:i.NMF,u=this._getArrayFromAccessor(n);for(let e=0,n=h.length;e<n;e++){let n=new o(h[e]+"."+U[r.path],t.array,u,c);"CUBICSPLINE"===s.interpolation&&this._createCubicSplineTrackInterpolant(n),a.push(n)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=Y(t.constructor),n=new Float32Array(t.length);for(let i=0,s=t.length;i<s;i++)n[i]=t[i]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof i.iLg?B:L)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new o,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,r=-1;"undefined"!=typeof navigator&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=(s=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||n||s&&r<98?this.textureLoader=new i.dpR(this.options.manager):this.textureLoader=new i.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new i.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}}function Z(e,t,n){let s=t.attributes,r=[];for(let t in s){let i=N[t]||t.toLowerCase();i in e.attributes||r.push(function(t,i){return n.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}(s[t],i))}if(void 0!==t.indices&&!e.index){let i=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});r.push(i)}return i.epp.workingColorSpace!==i.GUF&&"COLOR_0"in s&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(i.epp.workingColorSpace,'" not supported.')),X(e,t),!function(e,t,n){let s=t.attributes,r=new i.ZzF;if(void 0===s.POSITION)return;{let e=n.json.accessors[s.POSITION],t=e.min,o=e.max;if(void 0!==t&&void 0!==o){if(r.set(new i.Pa4(t[0],t[1],t[2]),new i.Pa4(o[0],o[1],o[2])),e.normalized){let t=Y(O[e.componentType]);r.min.multiplyScalar(t),r.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let o=t.targets;if(void 0!==o){let e=new i.Pa4,t=new i.Pa4;for(let i=0,s=o.length;i<s;i++){let s=o[i];if(void 0!==s.POSITION){let i=n.json.accessors[s.POSITION],r=i.min,o=i.max;if(void 0!==r&&void 0!==o){if(t.setX(Math.max(Math.abs(r[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(r[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(r[2]),Math.abs(o[2]))),i.normalized){let e=Y(O[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(e)}e.boundingBox=r;let a=new i.aLr;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=a}(e,t,n),Promise.all(r).then(function(){return void 0!==t.targets?function(e,t,n){let i=!1,s=!1,r=!1;for(let e=0,n=t.length;e<n;e++){let n=t[e];if(void 0!==n.POSITION&&(i=!0),void 0!==n.NORMAL&&(s=!0),void 0!==n.COLOR_0&&(r=!0),i&&s&&r)break}if(!i&&!s&&!r)return Promise.resolve(e);let o=[],a=[],l=[];for(let h=0,c=t.length;h<c;h++){let c=t[h];if(i){let t=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;o.push(t)}if(s){let t=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;a.push(t)}if(r){let t=void 0!==c.COLOR_0?n.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(t){let n=t[0],o=t[1],a=t[2];return i&&(e.morphAttributes.position=n),s&&(e.morphAttributes.normal=o),r&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e})}(e,t.targets,n):e})}},2675:function(e,t,n){n.d(t,{P:function(){return i}});let i={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n\n		varying vec2 vUv;\n\n		void main() {\n\n			vUv = uv;\n			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n		}",fragmentShader:"\n\n		uniform sampler2D tDiffuse;\n		uniform float h;\n\n		varying vec2 vUv;\n\n		void main() {\n\n			vec4 sum = vec4( 0.0 );\n\n			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n			gl_FragColor = sum;\n\n		}"}},3898:function(e,t,n){n.d(t,{Z:function(){return i}});let i={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n\n		varying vec2 vUv;\n\n		void main() {\n\n			vUv = uv;\n			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n		}",fragmentShader:"\n\n		uniform sampler2D tDiffuse;\n		uniform float v;\n\n		varying vec2 vUv;\n\n		void main() {\n\n			vec4 sum = vec4( 0.0 );\n\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n			gl_FragColor = sum;\n\n		}"}},9807:function(e,t,n){let i;function s(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}n.d(t,{P:function(){return l}}),Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class r{set(e,t,n,i,s,r,o,a,l){let h=this.elements;return h[0]=e,h[1]=i,h[2]=o,h[3]=t,h[4]=s,h[5]=a,h[6]=n,h[7]=r,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,s=this.elements,r=n[0],o=n[3],a=n[6],l=n[1],h=n[4],c=n[7],u=n[2],d=n[5],p=n[8],m=i[0],f=i[3],g=i[6],y=i[1],v=i[4],x=i[7],w=i[2],A=i[5],b=i[8];return s[0]=r*m+o*y+a*w,s[3]=r*f+o*v+a*A,s[6]=r*g+o*x+a*b,s[1]=l*m+h*y+c*w,s[4]=l*f+h*v+c*A,s[7]=l*g+h*x+c*b,s[2]=u*m+d*y+p*w,s[5]=u*f+d*v+p*A,s[8]=u*g+d*x+p*b,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],r=e[4],o=e[5],a=e[6],l=e[7],h=e[8];return t*r*h-t*o*l-n*s*h+n*o*a+i*s*l-i*r*a}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],r=e[4],o=e[5],a=e[6],l=e[7],h=e[8],c=h*r-o*l,u=o*a-h*s,d=l*s-r*a,p=t*c+n*u+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let m=1/p;return e[0]=c*m,e[1]=(i*l-h*n)*m,e[2]=(o*n-i*r)*m,e[3]=u*m,e[4]=(h*t-i*a)*m,e[5]=(i*s-o*t)*m,e[6]=d*m,e[7]=(n*a-l*t)*m,e[8]=(r*t-n*s)*m,this}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,r,o){let a=Math.cos(s),l=Math.sin(s);return this.set(n*a,n*l,-n*(a*r+l*o)+r+e,-i*l,i*a,-i*(-l*r+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(o.makeScale(e,t)),this}rotate(e){return this.premultiply(o.makeRotation(-e)),this}translate(e,t){return this.premultiply(o.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}constructor(e,t,n,i,s,o,a,l,h){r.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,s,o,a,l,h)}}let o=new r;function a(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}class l{static getDataURL(e){let t;if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===i&&(i=s("canvas")),i.width=e.width,i.height=e.height;let n=i.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=i}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let t=s("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*a(r[e]/255);return n.putImageData(i,0,0),t}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*a(t[e]/255)):t[e]=a(t[e]);return{data:t,width:e.width,height:e.height}}}}}}]);